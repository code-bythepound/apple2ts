{"version":3,"file":"static/js/233.4c3ede6a.chunk.js","mappings":"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","sources":["emulator/utility.ts","emulator/keyboard.ts","emulator/joystick.ts","emulator/softswitches.ts","emulator/convertdsk2woz.ts","emulator/decodedisk.ts","emulator/diskdata.ts","emulator/memory.ts","emulator/roms/slot_disk2_cx00.ts","emulator/roms/rom_2e.ts","emulator/instructions.ts","emulator/assembler.ts","emulator/assemblycode.ts","emulator/harddrivedata.ts","emulator/motherboard.ts","emulator/worker2main.ts","../webpack/bootstrap","../webpack/runtime/chunk loaded","../webpack/runtime/define property getters","../webpack/runtime/ensure chunk","../webpack/runtime/get javascript chunk filename","../webpack/runtime/get mini-css chunk filename","../webpack/runtime/hasOwnProperty shorthand","../webpack/runtime/publicPath","../webpack/runtime/importScripts chunk loading","../webpack/runtime/startup chunk dependencies","../webpack/startup"],"sourcesContent":["import { KeyboardEvent } from \"react\"\n\nexport enum STATE {\n  IDLE,\n  NEED_BOOT,\n  NEED_RESET,\n  RUNNING,\n  PAUSED,\n}\n\nexport enum DRIVE {\n  MOTOR_OFF,\n  MOTOR_ON,\n  TRACK_END,\n  TRACK_SEEK,\n}\n\nexport enum MODE {\n  IMPLIED,  // BRK\n  IMM,      // LDA #$01\n  ZP_REL,   // LDA $C0 or BCC $FF\n  ZP_X,     // LDA $C0,X\n  ZP_Y,     // LDX $C0,Y\n  ABS,      // LDA $1234\n  ABS_X,    // LDA $1234,X\n  ABS_Y,    // LDA $1234,Y\n  IND_X,    // LDA ($FF,X) or JMP ($1234,X)\n  IND_Y,    // LDA ($FF),Y\n  IND       // JMP ($1234) or LDA ($C0)\n}\n\n// A hack to determine if this is a relative instruction.\nexport const isRelativeInstr = (instr: string) => instr.startsWith('B') && instr !== \"BIT\" && instr !== \"BRK\"\n\n// export const toBinary = (value: number, ndigits = 8) => {\n//   return (\"0000000000000000\" + value.toString(2)).slice(-ndigits)\n// }\n\nconst address = (vLo: number, vHi: number) => (vHi*256 + vLo)\n\nexport const toHex = (value: number, ndigits = 2) => {\n  if (value > 0xFF) {\n    ndigits = 4\n  }\n  return (\"0000\" + value.toString(16).toUpperCase()).slice(-ndigits)\n}\n\nconst getPStatusString = (P: number) => {\n  const result = ((P & 0x80) ? 'N' : 'n') +\n    ((P & 0x40) ? 'V' : 'v') +\n    '-' +\n    ((P & 0x10) ? 'B' : 'b') +\n    ((P & 0x8) ? 'D' : 'd') +\n    ((P & 0x4) ? 'I' : 'i') +\n    ((P & 0x2) ? 'Z' : 'z') +\n    ((P & 0x1) ? 'C' : 'c')\n  return result\n}\n\nexport const getProcessorStatus = (s6502: STATE6502) => {\n  return (\n    `A=${toHex(s6502.Accum)} X=${toHex(s6502.XReg)} ` +\n    `Y=${toHex(s6502.YReg)} P=${toHex(s6502.PStatus)} ${getPStatusString(s6502.PStatus)} S=${toHex(s6502.StackPtr)}`\n  )\n}\n\nconst getStack = (s6502: STATE6502, stack: Array<string>, stackvalues: Uint8Array) => {\n  const result = new Array<string>()\n  for (let i = 0xFF; i > s6502.StackPtr; i--) {\n    let value = \"$\" + toHex(stackvalues[i])\n    let cmd = stack[i]\n    if ((stack[i].length > 3) && (i - 1) > s6502.StackPtr) {\n      if (stack[i-1] === \"JSR\" || stack[i-1] === \"BRK\") {\n        i--\n        value += toHex(stackvalues[i])\n      } else {\n        cmd = ''\n      }\n    }\n    value = (value + \"   \").substring(0, 6)\n    result.push(toHex(0x100 + i, 4) + \": \" + value + cmd)\n  }\n  return result\n}\n\nexport const getStatus = (s6502: STATE6502, stack: Array<string>, mem: Uint8Array) => {\n  const status = Array<String>(40).fill(\"\")\n  const stackString = getStack(s6502, stack, mem.slice(256, 512))\n  for (let i = 0; i < Math.min(20, stackString.length); i++) {\n    status[i] = stackString[i]\n  }\n  for (let j = 0; j < 16; j++) {\n    let s = \"<b>\" + toHex(16 * j) + \"</b>:\"\n    for (let i = 0; i < 16; i++) {\n      s += \" \" + toHex(mem[j * 16 + i])\n    }\n    status[status.length - 16 + j] = s\n  }\n  return status.join(\"<br/>\")\n}\n\nconst modeString = (mode: MODE) => {\n  let prefix = \"\"\n  let suffix = \"\"\n  switch (mode) {\n    case MODE.IMM:\n      prefix = \"#\"\n      break\n    case MODE.ZP_X:\n    case MODE.ABS_X:\n      suffix = \",X\"\n      break\n    case MODE.ZP_Y:\n    case MODE.ABS_Y:\n      suffix = \",Y\"\n      break\n    case MODE.IND:\n      prefix = \"(\"\n      suffix = \")\"\n      break\n    case MODE.IND_X:\n      prefix = \"(\"\n      suffix = \",X)\"\n      break\n    case MODE.IND_Y:\n      prefix = \"(\"\n      suffix = \"),Y\"\n      break\n  }\n  return [prefix, suffix]\n}\n\nexport const getInstrString = (code: PCodeInstr, vLo: number, vHi: number, PC: number) => {\n  let result = `${toHex(PC,4)}`\n  if (code) {\n    let [prefix, suffix] = modeString(code.mode)\n    if (code.PC >= 2) {\n      prefix = `   ${code.name}   ${prefix}$`\n    }\n    if (isRelativeInstr(code.name)) {\n      // The extra +2 is for the branch instruction itself\n      const addr = PC + 2 + (vLo > 127 ? vLo - 256 : vLo)\n      result += `${prefix}${toHex(addr, 4)}${suffix}`\n    } else {\n      switch (code.PC) {\n        case 1:\n          result += `   ${code.name}`\n          break\n        case 2:\n          result += `${prefix}${toHex(vLo)}${suffix}`\n          break\n        case 3:\n          result += `${prefix}${toHex(address(vLo, vHi),4)}${suffix}`\n          break\n      }\n    }\n  } else {\n    result += \"         ???\"\n  }\n  return result\n}\n\nexport const convertAppleKey = (e: KeyboardEvent, uppercase=false) => {\n  let key = 0\n  if (e.key.length === 1) {\n    if (e.metaKey || e.altKey) {\n      return 0\n    }\n    key = e.key.charCodeAt(0)\n    if (e.ctrlKey) {\n      if (key >= 0x40 && key <= 0x7E) {\n        key &= 0b00011111\n      } else {\n        return 0\n      }\n    } else if (uppercase) {\n      key = e.key.toUpperCase().charCodeAt(0)\n    }\n  } else {\n    const keymap: { [key: string]: number } = {\n      Enter: 13,\n      ArrowRight: 21,\n      ArrowLeft: 8,\n      Backspace: 8,\n      ArrowUp: 11,\n      ArrowDown: 10,\n      Escape: 27,\n      Shift: -1,\n      Control: -1\n    };\n    if (e.key === \"Backspace\" && e.shiftKey) {\n      key = 0x7F\n    } else if (e.key in keymap) {\n      key = keymap[e.key]\n    }\n  }\n  return key\n};\n\nexport const getPrintableChar = (value: number, isAltCharSet: boolean) => {\n  let v1 = value\n  if (isAltCharSet) {\n    if ((v1 >= 0 && v1 <= 31) || (v1 >= 64 && v1 <= 95)) {\n      v1 += 64\n    } else if (v1 >= 128 && v1 <= 159) {\n      v1 -= 64\n    } else if (v1 >= 160) {\n      v1 -= 128\n    }\n  } else {\n    // Shift Ctrl chars and second ASCII's into correct ASCII range\n    if ((v1 >= 0 && v1 <= 0x1f) || (v1 >= 0x60 && v1 <= 0x9f)) {\n      v1 += 64\n    }\n    v1 &= 0b01111111\n  }\n  return v1\n}\n\nlet zpPrev = new Uint8Array(1)\nexport const debugZeroPage = (zp: Uint8Array) => {\n  if (zpPrev.length === 1) zpPrev = zp\n  let diff = \"\"\n  for (let i = 0; i < 256; i++) {\n    if (zp[i] !== zpPrev[i]) {\n      diff += \" \" + toHex(i) + \":\" + toHex(zpPrev[i]) + \">\" + toHex(zp[i])\n    }\n  }\n  if (diff !== \"\") console.log(diff)\n  zpPrev = zp\n}\n\nexport const toASCII = (s: String) => s.split('').map(char => char.charCodeAt(0))\nexport const uint16toBytes = (n: number) => [n & 0xFF, (n >>> 8) & 0xFF]\nexport const uint32toBytes = (n: number) => [n & 0xFF, (n >>> 8) & 0xFF,\n  (n >>> 16) & 0xFF, (n >>> 24) & 0xFF]\n","import { memC000 } from \"./memory\"\nimport { doSaveTimeSlice } from \"./motherboard\"\n\nlet keyBuffer = ''\nexport const popKey = () => {\n  if (memC000[0] < 128 && keyBuffer !== '') {\n    let key = keyBuffer.charCodeAt(0)\n    keyPress(key)\n    keyBuffer = keyBuffer.slice(1)\n    if (keyBuffer.length === 0) {\n      doSaveTimeSlice()\n    }\n  }\n}\nexport const addToBuffer = (text: String) => {\n  keyBuffer += text\n  popKey()\n}\n\nconst keyPress = (key: number) => {\n  memC000.fill(key | 0b10000000, 0, 32)\n}\n\n","import { memC000 } from \"./memory\"\nimport { SWITCHES } from \"./softswitches\"\n// import { doSaveTimeSlice } from \"./motherboard\"\n// import { addToBuffer } from \"./keyboard\"\n\nlet gamePad: EmuGamepad | null = null\nconst maxTimeoutCycles = Math.trunc(0.0028*1.020484e6)\nlet paddle0timeout = maxTimeoutCycles / 2\nlet paddle1timeout = maxTimeoutCycles / 2\n// let prevPaddle0timeout = paddle0timeout\n// let prevPaddle1timeout = paddle1timeout\nlet countStart = 0\nlet leftAppleDown = false\nlet rightAppleDown = false\nlet leftButtonDown = false\nlet rightButtonDown = false\nlet isLeftDown = false\nlet isRightDown = false\n\nexport const setButtonState = () => {\n  const wasLeftDown = isLeftDown\n  const wasRightDown = isRightDown\n  isLeftDown = leftAppleDown || leftButtonDown\n  isRightDown = rightAppleDown || rightButtonDown\n  SWITCHES.PB0.isSet = (leftAppleDown || leftButtonDown)\n  SWITCHES.PB1.isSet = (isRightDown || rightButtonDown)\n  if ((isLeftDown && !wasLeftDown) || (isRightDown && !wasRightDown)) {\n//    doSaveTimeSlice()\n  }\n}\n\nexport const pressAppleCommandKey = (isDown: boolean, left: boolean) => {\n  if (left) {\n    leftAppleDown = isDown\n  } else {\n    rightAppleDown = isDown\n  }\n  setButtonState()\n}\n\nconst memSet1 = (addr: number, value: number) => {\n  memC000[addr - 0xC000] = value\n}\nexport const resetJoystick = (cycleCount: number) => {\n  memSet1(0xC064, 0x80)\n  memSet1(0xC065, 0x80)\n  memSet1(0xC066, 0)\n  memSet1(0xC067, 0)\n  countStart = cycleCount\n}\n\n// const largeDiff = (v1: number, v2: number) => {\n//   return (Math.abs(v1 - v2) > 0.1 * maxTimeoutCycles)\n// }\n\nexport const checkJoystickValues = (cycleCount: number) => {\n//   if (largeDiff(prevPaddle0timeout, paddle0timeout) ||\n//     largeDiff(prevPaddle1timeout, paddle1timeout)) {\n//     prevPaddle0timeout = paddle0timeout\n//     prevPaddle1timeout = paddle1timeout\n//     doSaveTimeSlice()\n//   }\n  const diff = cycleCount - countStart\n  memSet1(0xC064, (diff < paddle0timeout) ? 0x80 : 0)\n  memSet1(0xC065, (diff < paddle1timeout) ? 0x80 : 0)\n}\n\nconst defaultButtons = [\n  () => {leftButtonDown = true},\n  () => {rightButtonDown = true},\n  () => {leftButtonDown = true},\n  () => {rightButtonDown = true},\n  () => {leftButtonDown = true},\n  () => {rightButtonDown = true},\n  () => {leftButtonDown = true},\n  () => {rightButtonDown = true},\n  () => {leftButtonDown = true},\n  () => {rightButtonDown = true},\n  () => {leftButtonDown = true},\n  () => {rightButtonDown = true},\n  () => {paddle1timeout = 0},\n  () => {paddle1timeout = maxTimeoutCycles},\n  () => {paddle0timeout = 0},\n  () => {paddle0timeout = maxTimeoutCycles},\n]\n\n// const wolf = [\n//   () => {leftButtonDown = true},\n//   () => {rightButtonDown = true},\n//   () => {addToBuffer('U'.charCodeAt(0))},\n//   () => {addToBuffer('T'.charCodeAt(0))},\n//   () => {leftButtonDown = true},\n//   () => {rightButtonDown = true},\n//   () => {addToBuffer(' '.charCodeAt(0))},\n//   () => {addToBuffer('\\r')},\n//   () => {leftButtonDown = true},\n//   () => {rightButtonDown = true},\n//   () => {leftButtonDown = true},\n//   () => {rightButtonDown = true},\n//   () => {paddle1timeout = 0},\n//   () => {paddle1timeout = maxTimeoutCycles},\n//   () => {paddle0timeout = 0},\n//   () => {paddle0timeout = maxTimeoutCycles},\n// ]\n\n// AZTEC Controls\n// A, D: move left or right (while using weapon); face left or right (otherwise)\n// W: go to walk mode\n// R: go to run mode\n// C: go to climb mode (ascends steps or mounds)\n// J: jump\n// S: stop walking, running, or climbing\n// G: crawl once\n// P: set explosive (must be crawling)\n// O: open box or clear trash mound\n// L: look in box\n// T: take object from ground or box\n// Z: inventory\n// F: draw machete if you have one, gun otherwise, does nothin if unarmed\n// S: turn around while using weapon\n// L: lunge while using machete\n// M: stab at ground while using machete\n// G: switch from machete to gun\n// <spacebar>: fire gun\n// let moving = false\n// const aztec = [\n//   () => {addToBuffer('J')},  // 0 A\n//   () => {rightButtonDown = true},  // 1 B\n//   () => {addToBuffer('U')},  // 2 X\n//   () => {addToBuffer('T')},  // 3 Y\n//   () => {leftButtonDown = true},  // 4 LB\n//   () => {rightButtonDown = true},  // 5 RB\n//   () => {addToBuffer('O'); addToBuffer('L'); addToBuffer('T')},  // 6 LT\n//   () => {addToBuffer(' ')},  // 7 RT\n//   () => {leftButtonDown = true},  // 8 Select?\n//   () => {rightButtonDown = true},  // 9 Start?\n//   () => {leftButtonDown = true},  // 10 Left thumb\n//   () => {rightButtonDown = true},  // 11 Right thumb\n//   () => {addToBuffer('R')},  // 12 D-pad U\n//   () => {addToBuffer('W')},  // 13 D-pad D\n//   () => {\n//     addToBuffer(moving ? 'S' : 'A')\n//     moving = !moving\n//     if (moving) {addToBuffer('W')}},  // 14 D-pad L\n//   () => {\n//     addToBuffer(moving ? 'S' : 'D')\n//     moving = !moving\n//     if (moving) {addToBuffer('W')}},  // 15 D-pad R\n// ]\n\nlet funcs = defaultButtons\n// funcs = aztec\n\nexport const setGamepad = (gamePadIn: EmuGamepad) => {\n  gamePad = gamePadIn\n}\n\nconst nearZero = (value: number) => {return value > -0.01 && value < 0.01}\n\nexport const handleGamepad = () => {\n  if (gamePad && gamePad.connected) {\n    let xstick = gamePad.axes[0]\n    let ystick = gamePad.axes[1]\n    if (nearZero(gamePad.axes[0]) && nearZero(gamePad.axes[1])) {\n      xstick = gamePad.axes[2]\n      ystick = gamePad.axes[3]\n    }\n    if (Math.abs(xstick) < 0.01) xstick = 0\n    if (Math.abs(ystick) < 0.01) ystick = 0\n    const dist = Math.sqrt(xstick * xstick + ystick * ystick)\n    const clip = 0.95 * ((dist === 0) ? 1 :\n      Math.max(Math.abs(xstick), Math.abs(ystick)) / dist)\n    xstick = Math.min(Math.max(-clip, xstick), clip)\n    ystick = Math.min(Math.max(-clip, ystick), clip)\n    paddle0timeout = Math.trunc(maxTimeoutCycles*(xstick + clip)/(2*clip))\n    paddle1timeout = Math.trunc(maxTimeoutCycles*(ystick + clip)/(2*clip))\n    leftButtonDown = false\n    rightButtonDown = false\n    gamePad.buttons.forEach((button, i) => {\n      if (button && i < funcs.length) {\n//        console.log(i)\n        funcs[i]()\n      }\n    });\n    setButtonState()\n  }\n\n}\n","import { memC000 } from \"./memory\"\nimport { popKey } from \"./keyboard\"\nimport { passClickSpeaker } from \"./worker2main\"\nimport { resetJoystick, checkJoystickValues } from \"./joystick\"\nimport { toHex } from \"./utility\"\n\ntype tSetFunc = ((addr: number, cycleCount: number) => void) | null\n\ntype softSwitch = {\n  offAddr: number\n  onAddr: number\n  isSetAddr: number\n  writeOnly: boolean\n  isSet: boolean\n  setFunc: tSetFunc\n}\n\nconst sswitch: Array<softSwitch> = []\n\nconst NewSwitch = (offAddr: number, isSetAddr: number,\n  writeOnly = false,\n  setFunc: tSetFunc = null): softSwitch => {\n  const result: softSwitch = {\n    offAddr: offAddr,\n    onAddr: offAddr + 1,\n    isSetAddr: isSetAddr,\n    writeOnly: writeOnly,\n    isSet: false,\n    setFunc: setFunc,\n  }\n  if (offAddr >= 0xC000) {\n    sswitch[offAddr - 0xC000] = result\n    sswitch[offAddr + 1 - 0xC000] = result\n  } \n  if (isSetAddr >= 0xC000) {\n    sswitch[isSetAddr - 0xC000] = result\n  } \n  return result\n}\n\nconst SLOT6 = 0x60\n\nconst rand = () => Math.floor(256 * Math.random())\n\nexport const handleBankedRAM = (addr: number) => {\n  // Only keep bits 0, 1, 3 of the 0xC08* number\n  addr &= 0b1011\n  SWITCHES.READBSR2.isSet = addr === 0\n  SWITCHES.WRITEBSR2.isSet = addr === 1\n  SWITCHES.OFFBSR2.isSet = addr === 2\n  SWITCHES.RDWRBSR2.isSet = addr === 3\n  SWITCHES.READBSR1.isSet = addr === 8\n  SWITCHES.WRITEBSR1.isSet = addr === 9\n  SWITCHES.OFFBSR1.isSet = addr === 0x0A\n  SWITCHES.RDWRBSR1.isSet = addr === 0x0B\n  // Set soft switches for reading the bank-switched RAM status\n  SWITCHES.BSRBANK2.isSet = (addr <= 3)\n  SWITCHES.BSRREADRAM.isSet = [0, 3, 8, 0x0B].includes(addr)\n}\n\nexport const SWITCHES = {\n  STORE80: NewSwitch(0xC000, 0xC018, true),\n  RAMRD: NewSwitch(0xC002, 0xC013, true),\n  RAMWRT: NewSwitch(0xC004, 0xC014, true),\n  INTCXROM: NewSwitch(0xC006, 0xC015, true),\n  ALTZP: NewSwitch(0xC008, 0xC016, true),\n  SLOTC3ROM: NewSwitch(0xC00A, 0xC017, true),\n  COLUMN80: NewSwitch(0xC00C, 0xC01F, true),\n  ALTCHARSET: NewSwitch(0xC00E, 0xC01E, true),\n  KBRDSTROBE: NewSwitch(0, 0xC010, false, () => {\n    memC000.fill(memC000[0] & 0b01111111, 0, 32)\n    popKey()\n  }),\n  BSRBANK2: NewSwitch(0, 0xC011),    // status location, not a switch\n  BSRREADRAM: NewSwitch(0, 0xC012),  // status location, not a switch\n  CASSOUT: NewSwitch(0xC020, 0, false, () => {\n    memC000.fill(rand(), 0x20, 16)\n  }),\n  SPEAKER: NewSwitch(0xC030, 0, false, (addr, cycleCount) => {\n    memC000.fill(rand(), 0x30, 16)\n    passClickSpeaker(cycleCount)\n  }),\n  EMUBYTE: NewSwitch(0, 0xC04F, false, () => {memC000[0x4F] = 0xCD}),\n  TEXT: NewSwitch(0xC050, 0xC01A),\n  MIXED: NewSwitch(0xC052, 0xC01B),\n  PAGE2: NewSwitch(0xC054, 0xC01C),\n  HIRES: NewSwitch(0xC056, 0xC01D),\n  AN0: NewSwitch(0xC058, 0),\n  AN1: NewSwitch(0xC05A, 0),\n  AN2: NewSwitch(0xC05C, 0),\n  AN3: NewSwitch(0xC05E, 0),\n  CASSIN1: NewSwitch(0, 0xC060, false, () => {memC000[0x60] = rand()}),\n  PB0: NewSwitch(0, 0xC061),  // status location, not a switch\n  PB1: NewSwitch(0, 0xC062),  // status location, not a switch\n  PB2: NewSwitch(0, 0xC063),  // status location, not a switch\n  JOYSTICK12: NewSwitch(0xC064, 0, false, (addr, cycleCount) => {\n    checkJoystickValues(cycleCount)\n  }),\n  CASSIN2: NewSwitch(0, 0xC068, false, () => {memC000[0x68] = rand()}),\n  JOYSTICKRESET: NewSwitch(0xC070, 0, false, (addr, cycleCount) => {\n    resetJoystick(cycleCount)\n    memC000[0x70] = rand()\n  }),\n  READBSR2: NewSwitch(0xC080, 0, false, (addr) => {handleBankedRAM(addr)}),\n  WRITEBSR2: NewSwitch(0xC081, 0, false, (addr) => {handleBankedRAM(addr)}),\n  OFFBSR2: NewSwitch(0xC082, 0, false, (addr) => {handleBankedRAM(addr)}),\n  RDWRBSR2: NewSwitch(0xC083, 0, false, (addr) => {handleBankedRAM(addr)}),\n  READBSR1: NewSwitch(0xC088, 0, false, (addr) => {handleBankedRAM(addr)}),\n  WRITEBSR1: NewSwitch(0xC089, 0, false, (addr) => {handleBankedRAM(addr)}),\n  OFFBSR1: NewSwitch(0xC08A, 0, false, (addr) => {handleBankedRAM(addr)}),\n  RDWRBSR1: NewSwitch(0xC08B, 0, false, (addr) => {handleBankedRAM(addr)}),\n  DRVSM0: NewSwitch(0xC080 + SLOT6, 0),\n  DRVSM1: NewSwitch(0xC082 + SLOT6, 0),\n  DRVSM2: NewSwitch(0xC084 + SLOT6, 0),\n  DRVSM3: NewSwitch(0xC086 + SLOT6, 0),\n  DRIVE: NewSwitch(0xC088 + SLOT6, 0),\n  DRVSEL: NewSwitch(0xC08A + SLOT6, 0),\n  DRVDATA: NewSwitch(0xC08C + SLOT6, 0),\n  DRVWRITE: NewSwitch(0xC08E + SLOT6, 0),\n}\n\nSWITCHES.TEXT.isSet = true\n\n// const skipDebugFlags = [0xC000, 0xC001, 0xC00D, 0xC00F, 0xC030, 0xC054, 0xC055, 0xC01F]\n\nexport const checkSoftSwitches = (addr: number,\n  calledFromMemSet: boolean, cycleCount: number) => {\n  // if (!skipDebugFlags.includes(addr)) {\n  //   const s = memC000[addr - 0xC000] > 0x80 ? 1 : 0\n  //   console.log(`${cycleCount} $${toHex(s6502.PC)}: $${toHex(addr)} [${s}] ${calledFromMemSet ? \"set\" : \"\"}`)\n  // }\n  if (sswitch[addr - 0xC000]) {\n    const sswitch1 = sswitch[addr - 0xC000]\n    const func = sswitch1.setFunc\n    if (addr === sswitch1.offAddr || addr === sswitch1.onAddr) {\n      if (func) {\n        func(addr, cycleCount)\n      } else {\n        if (!sswitch1.writeOnly || calledFromMemSet) {\n          sswitch1.isSet = (addr === sswitch1.onAddr)\n        }\n        if (sswitch1.isSetAddr) {\n          memC000[sswitch1.isSetAddr - 0xC000] = sswitch1.isSet ? 0x8D : 0x0D\n        }\n      }\n    } else if (addr === sswitch1.isSetAddr) {\n      if (func) {\n        func(addr, cycleCount)\n      } else {\n        memC000[addr - 0xC000] = sswitch1.isSet ? 0x8D : 0x0D\n      }\n    }\n    return\n  }\n\n  console.error(\"Unknown softswitch \" + toHex(addr))\n}\n","// Code converted from the C code library available at:\n// https://github.com/mr-stivo/dsk2woz2\n//\nimport { toASCII, uint16toBytes, uint32toBytes } from \"./utility\"\n\n/**\n  Appends a byte to a woz at a supplied position: number, returning the\n  position immediately after the byte.\n  @param woz The woz to write into.\n  @param position The position to write at.\n  @param value The byte to write.\n  @returns The position immediately after the byte.\n*/\nconst write_byte = (woz: Uint8Array, position: number, value: number) => {\n  const shift = position & 7\n  const byte_position = position >>> 3\n  woz[byte_position] |= value >>> shift\n  if (shift) woz[byte_position+1] |= value << (8 - shift)\n  return position + 8;\n}\n\n/**\n  Encodes a byte into Apple 4-and-4 format and appends it to a woz.\n  @param woz The woz to write into.\n  @param position The position to write at.\n  @param value The byte to encode and write.\n  @returns The position immediately after the encoded byte.\n*/\nconst write_4_and_4 = (woz: Uint8Array, position: number, value: number) => {\n  position = write_byte(woz, position, (value >>> 1) | 0xAA);\n  position = write_byte(woz, position, value | 0xAA);\n  return position;\n}\n\n/**\n  Appends a 6-and-2-style 10-bit sync word to a woz.\n  @param woz The woz to write into.\n  @param position The position to write at.\n  @returns The position immediately after the sync word.\n*/\nconst write_sync = (woz: Uint8Array, position: number) => {\n  position = write_byte(woz, position, 0xFF);\n  // Skip two bits, i.e. leave them as 0s\n  return position + 2\n}\n\n/*!\n  Converts a 256-byte source woz into the 343 byte values that\n  contain the Apple 6-and-2 encoding of that woz.\n  @param dest The at-least-343 byte woz to which the encoded sector is written.\n  @param src The 256-byte source data.\n*/\nconst encode_6_and_2 = (src: Uint8Array) => {\n  const six_and_two_mapping = [\n    0x96, 0x97, 0x9A, 0x9B, 0x9D, 0x9E, 0x9F, 0xA6,\n    0xA7, 0xAB, 0xAC, 0xAD, 0xAE, 0xAF, 0xB2, 0xB3,\n    0xB4, 0xB5, 0xB6, 0xB7, 0xB9, 0xBA, 0xBB, 0xBC,\n    0xBD, 0xBE, 0xBF, 0xCB, 0xCD, 0xCE, 0xCF, 0xD3,\n    0xD6, 0xD7, 0xD9, 0xDA, 0xDB, 0xDC, 0xDD, 0xDE,\n    0xDF, 0xE5, 0xE6, 0xE7, 0xE9, 0xEA, 0xEB, 0xEC,\n    0xED, 0xEE, 0xEF, 0xF2, 0xF3, 0xF4, 0xF5, 0xF6,\n    0xF7, 0xF9, 0xFA, 0xFB, 0xFC, 0xFD, 0xFE, 0xFF\n  ];\n\n  const dest = new Uint8Array(343)\n\n  // Fill in byte values: the first 86 bytes contain shuffled\n  // and combined copies of the bottom two bits of the sector\n  // contents; the 256 bytes afterwards are the remaining\n  // six bits.\n  const bit_reverse = [0, 2, 1, 3];\n  for (let c = 0; c < 84; c++) {\n    dest[c] =\n      bit_reverse[src[c] & 3] |\n      (bit_reverse[src[c + 86] & 3] << 2) |\n      (bit_reverse[src[c + 172] & 3] << 4);\n  }\n  dest[84] =\n    (bit_reverse[src[84] & 3] << 0) |\n    (bit_reverse[src[170] & 3] << 2);\n  dest[85] =\n      (bit_reverse[src[85] & 3] << 0) |\n      (bit_reverse[src[171] & 3] << 2);\n\n  for (let c = 0; c < 256; c++) {\n    dest[86 + c] = src[c] >>> 2;\n  }\n\n  // Exclusive OR each byte with the one before it.\n  dest[342] = dest[341];\n  let location = 342;\n  while(location > 1) {\n    location--;\n    dest[location] ^= dest[location - 1];\n  }\n\n  // Map six-bit values up to full bytes.\n  for (let c = 0; c < 343; c++) {\n    dest[c] = six_and_two_mapping[dest[c]];\n  }\n  return dest\n}\n\n/*!\n  Converts a DSK-style track to a WOZ-style track.\n  @param dest The 6646-byte woz that will contain the WOZ track. Both track contents and the\n      proper suffix will be written.\n  @param src The 4096-byte woz that contains the DSK track — 16 instances of 256 bytes, each\n      a fully-decoded sector.\n  @param track_number The track number to encode into this track.\n  @param is_prodos @c true if the DSK image is in Pro-DOS order; @c false if it is in DOS 3.3 order.\n*/\nconst serialise_track = (src: Uint8Array, track_number: number, is_prodos: boolean) => {\n  let track_position = 0;    // This is the track position **in bits**.\n  const dest = new Uint8Array(6646).fill(0)\n\n  // Write gap 1.\n  for (let c = 0; c < 16; c++) {\n      track_position = write_sync(dest, track_position);\n  }\n\n  // Step through the sectors in physical order.\n  for (let sector = 0; sector < 16; sector++) {\n    // Prologue.\n    track_position = write_byte(dest, track_position, 0xD5);\n    track_position = write_byte(dest, track_position, 0xAA);\n    track_position = write_byte(dest, track_position, 0x96);\n    // Volume, track, setor and checksum, all in 4-and-4 format.\n    track_position = write_4_and_4(dest, track_position, 254);\n    track_position = write_4_and_4(dest, track_position, track_number);\n    track_position = write_4_and_4(dest, track_position, sector);\n    track_position = write_4_and_4(dest, track_position, 254 ^ track_number ^ sector);\n    // Epilogue.\n    track_position = write_byte(dest, track_position, 0xDE);\n    track_position = write_byte(dest, track_position, 0xAA);\n    track_position = write_byte(dest, track_position, 0xEB);\n\n    // Write gap 2.\n    for (let c = 0; c < 7; c++) {\n        track_position = write_sync(dest, track_position);\n    }\n\n    // Write the sector body.\n    // Prologue.\n    track_position = write_byte(dest, track_position, 0xD5);\n    track_position = write_byte(dest, track_position, 0xAA);\n    track_position = write_byte(dest, track_position, 0xAD);\n\n    // Map from this physical sector to a logical sector.\n    const ls = (sector === 15) ? 15 : ((sector * (is_prodos ? 8 : 7)) % 15);\n\n    // Sector contents.\n    const contents = encode_6_and_2(src.slice(ls * 256, ls * 256 + 256));\n    for (let c = 0; c < contents.length; c++) {\n      track_position = write_byte(dest, track_position, contents[c]);            \n    }\n\n    // Epilogue.\n    track_position = write_byte(dest, track_position, 0xDE);\n    track_position = write_byte(dest, track_position, 0xAA);\n    track_position = write_byte(dest, track_position, 0xEB);\n\n    // Write gap 3.\n    for (let c = 0; c < 16; c++) {\n      track_position = write_sync(dest, track_position);\n    }\n  }\n  return dest\n}\n\nexport const convertdsk2woz = (dskData: Uint8Array, isPO: boolean) => {\n  if (dskData.length !== 35 * 16 * 256) {\n    return new Uint8Array()\n  }\n  const woz = new Uint8Array(512*3 + 512*35*13).fill(0)\n  woz.set(toASCII(\"WOZ2\\xFF\\n\\r\\n\"), 0)\n  woz.set(toASCII(\"INFO\"), 12)\n  woz[16] = 60    // Chunk size\n  woz[20] = 2     // INFO version: 2\n  woz[21] = 1     // Disk type: 5.25\"\n  woz[22] = 0     // Write protection: disabled\n  woz[23] = 0     // Cross-track synchronised image: no\n  woz[24] = 1     // MC3470 fake bits have been removed: yes\n  woz.fill(32, 25, 57)\n  woz.set(toASCII(\"Apple2TS (CT6502)\"), 25)\n  woz[57] = 1     // Disk sides: 1\n  woz[58] = 0     // Boot sector format: 0 (unknown)\n  woz[59] = 32    // Optimal bit timing: 32 (4us)\n  woz[60] = 0     // Compatible hardware: 0 (unknown)\n  woz[62] = 0     // Required RAM: 0 (unknown)\n  woz[64] = 13    // Largest track blocks (512 bytes): 13 (default track size)\n  woz.set(toASCII(\"TMAP\"), 80)\n  woz[84] = 160    // Chunk size\n  woz.fill(0xFF, 88, 88 + 160)  // Fill the TMAP with empty tracks\n  // Now fill in the quarter tracks around each whole track\n  let offset = 0;\n  for (let c = 0; c < 35; c++) {\n    offset = 88 + (c << 2)\n    if (c > 0) woz[offset - 1] = c\n    woz[offset] = woz[offset + 1] = c\n  }\n  woz.set(toASCII(\"TRKS\"), 248)\n  woz.set(uint32toBytes(1280 + 35*13*512), 252)\n  for (let c = 0; c < 35; c++) {\n    offset = 256 + (c << 3);\n    woz.set(uint16toBytes(3 + c*13), offset)  // start block\n    woz[offset + 2] = 13   // block count\n    woz.set(uint32toBytes(50304), offset + 4)  // start block\n    const trackInput = dskData.slice(c * 16 * 256, (c + 1) * 16 * 256)\n    const trackData = serialise_track(trackInput, c, isPO)\n    offset = 512 * (3 + 13 * c)\n    woz.set(trackData, offset)\n  }\n  return woz\n}\n","import { convertdsk2woz } from \"./convertdsk2woz\"\n\nlet crcTable = new Uint32Array(256).fill(0)\n\nconst makeCRCTable = () => {\n  let c;\n  for (let n =0; n < 256; n++) {\n    c = n;\n    for (let k =0; k < 8; k++) {\n      c = ((c&1) ? (0xEDB88320 ^ (c >>> 1)) : (c >>> 1));\n    }\n    crcTable[n] = c;\n  }\n}\n\nexport const crc32 = (data: Uint8Array, offset = 0) => {\n  if (crcTable[255] === 0) {\n    makeCRCTable()\n  }\n  let crc = 0 ^ (-1);\n  for (let i = offset; i < data.length; i++) {\n    crc = (crc >>> 8) ^ crcTable[(crc ^ data[i]) & 0xFF];\n  }\n\n  return (crc ^ (-1)) >>> 0;\n};\n\nconst decodeWoz2 = (driveState: DriveState, diskData: Uint8Array): boolean => {\n  const woz2 = [0x57, 0x4F, 0x5A, 0x32, 0xFF, 0x0A, 0x0D, 0x0A]\n  const isWoz2 = woz2.find((value, i) => value !== diskData[i]) === undefined\n  if (!isWoz2) return false\n  driveState.isWriteProtected = diskData[22] === 1\n  const crc = diskData.slice(8, 12)\n  const storedCRC = crc[0] + (crc[1] << 8) + (crc[2] << 16) + crc[3] * (2 ** 24)\n  const actualCRC = crc32(diskData, 12)\n  if (storedCRC !== 0 && storedCRC !== actualCRC) {\n    alert(\"CRC checksum error: \" + driveState.filename)\n    return false\n  }\n  for (let htrack=0; htrack < 80; htrack++) {\n    const tmap_index = diskData[88 + htrack * 2]\n    if (tmap_index < 255) {\n      const tmap_offset = 256 + 8 * tmap_index\n      const trk = diskData.slice(tmap_offset, tmap_offset + 8)\n      driveState.trackStart[htrack] = 512*(trk[0] + (trk[1] << 8))\n      // const nBlocks = trk[2] + (trk[3] << 8)\n      driveState.trackNbits[htrack] = trk[4] + (trk[5] << 8) + (trk[6] << 16) + trk[7] * (2 ** 24)\n    } else {\n      driveState.trackStart[htrack] = 0\n      driveState.trackNbits[htrack] = 51200\n//        console.log(`empty woz2 track ${htrack / 2}`)\n    }\n  }\n  return true\n}\n\nconst decodeWoz1 = (driveState: DriveState, diskData: Uint8Array): boolean => {\n  const woz1 = [0x57, 0x4F, 0x5A, 0x31, 0xFF, 0x0A, 0x0D, 0x0A]\n  const isWoz1 = woz1.find((value, i) => value !== diskData[i]) === undefined\n  if (!isWoz1) {\n    return false\n  }\n  driveState.isWriteProtected = diskData[22] === 1\n  for (let htrack=0; htrack < 80; htrack++) {\n    const tmap_index = diskData[88 + htrack * 2]\n    if (tmap_index < 255) {\n      driveState.trackStart[htrack] = 256 + tmap_index * 6656\n      const trk = diskData.slice(driveState.trackStart[htrack] + 6646,\n        driveState.trackStart[htrack] + 6656)\n      driveState.trackNbits[htrack] = trk[2] + (trk[3] << 8)\n    } else {\n      driveState.trackStart[htrack] = 0\n      driveState.trackNbits[htrack] = 51200\n//        console.log(`empty woz1 track ${htrack / 2}`)\n    }\n  }\n  return true\n}\n\nconst isDSK = (filename: String) => {\n  const f = filename.toUpperCase()\n  const isDSK = f.endsWith(\".DSK\") || f.endsWith(\".DO\")\n  const isPO = f.endsWith(\".PO\")\n  return isDSK || isPO\n}\n\nconst decodeDSK = (driveState: DriveState, diskData: Uint8Array) => {\n  let f = driveState.filename.toUpperCase()\n  const isPO = f.endsWith(\".PO\")\n  diskData = convertdsk2woz(diskData, isPO)\n  if (diskData.length > 0) {\n    const i = f.lastIndexOf('.')\n    f = f.substring(0, i)\n    driveState.filename = f + '.woz'\n    driveState.diskHasChanges = true\n  }\n  return diskData\n}\n\nexport const decodeDiskData = (driveState: DriveState, diskData: Uint8Array): Uint8Array => {\n  driveState.diskHasChanges = false\n  if (isDSK(driveState.filename)) {\n    diskData = decodeDSK(driveState, diskData)\n  }\n  if (decodeWoz2(driveState, diskData)) {\n    return diskData\n  }\n  if (decodeWoz1(driveState, diskData)) {\n    return diskData\n  }\n  if (decodeDSK(driveState, diskData)) {\n    return diskData\n  }\n  console.error(\"Unknown disk format.\")\n  driveState.filename = \"\"\n  return new Uint8Array()\n}\n","import { Buffer } from \"buffer\"\nimport { passDriveProps, passDriveSound } from \"./worker2main\"\nimport { SWITCHES } from \"./softswitches\"\nimport { cycleCount } from './instructions'\nimport { toHex, DRIVE } from \"./utility\"\nimport { decodeDiskData } from \"./decodedisk\"\n\nconst initDriveState = (): DriveState => {\n  return {\n    filename: \"\",\n    halftrack: 0,\n    prevHalfTrack: 0,\n    writeMode: false,\n    currentPhase: 0,\n    diskHasChanges: false,\n    motorRunning: false,\n    trackStart: Array<number>(80),\n    trackNbits: Array<number>(80),\n    trackLocation: 0,\n    isWriteProtected: false\n  }\n}\nlet driveState: DriveState[] = [initDriveState(), initDriveState()];\nconst diskData = [new Uint8Array(), new Uint8Array()]\n\nlet currentDrive = 0\nlet motorOffTimeout: any = 0\n\nexport const getDriveState = () => {\n  const driveData = [Buffer.from(diskData[0]).toString(\"base64\"),\n    Buffer.from(diskData[1]).toString(\"base64\")]\n  return { currentDrive: currentDrive, driveState: driveState, driveData: driveData }\n}\n\nconst passData = () => {\n  for (let i = 0; i < driveState.length; i++) {\n    const dprops: DriveProps = {\n      hardDrive: false,\n      drive: i,\n      filename: driveState[i].filename,\n      status: (driveState[i].halftrack / 2).toString(),\n      motorRunning: driveState[i].motorRunning,\n      halftrack: driveState[i].halftrack,\n      diskHasChanges: driveState[i].diskHasChanges,\n      diskData: diskData[i]\n    }\n    passDriveProps(dprops)\n  }\n}\n\nexport const setDriveState = (newState: any) => {\n  currentDrive = newState.currentDrive\n  driveState = newState.driveState\n  for (let i = 0; i < driveState.length; i++) {\n    if (\"fileName\" in newState.driveState[i]) {\n      driveState[i].filename = newState.driveState[i].fileName\n      delete (driveState[i] as any).fileName\n    }\n    if (\"diskImageHasChanges\" in newState.driveState[i]) {\n      driveState[i].diskHasChanges = newState.driveState[i].diskImageHasChanges\n      delete (driveState[i] as any).diskImageHasChanges\n    }\n    if (\"motorIsRunning\" in newState.driveState[i]) {\n      driveState[i].motorRunning = newState.driveState[i].motorIsRunning\n      delete (driveState[i] as any).motorIsRunning\n    }\n  }\n  diskData[0] = new Uint8Array(Buffer.from(newState.driveData[0], 'base64'))\n  diskData[1] = new Uint8Array(Buffer.from(newState.driveData[1], 'base64'))\n  passData()\n}\n\nexport const doResetDrive = () => {\n  SWITCHES.DRIVE.isSet = false\n  doMotorTimeout()\n  driveState[0].halftrack = 68\n  driveState[0].prevHalfTrack = 68\n  driveState[1].halftrack = 68\n  driveState[1].prevHalfTrack = 68\n  passData()\n}\n\nexport const doPauseDrive = (resume = false) => {\n  if (resume) {\n    if (driveState[currentDrive].motorRunning) {\n      startMotor()\n    }\n  } else {\n    passDriveSound(DRIVE.MOTOR_OFF)\n  }\n}\n\nconst moveHead = (offset: number) => {\n  const dd = driveState[currentDrive]\n  if (dd.trackStart[dd.halftrack] > 0) {\n    dd.prevHalfTrack = dd.halftrack\n  }\n  dd.halftrack += offset\n  if (dd.halftrack < 0 || dd.halftrack > 68) {\n    passDriveSound(DRIVE.TRACK_END)\n    dd.halftrack = (dd.halftrack < 0) ? 0 : (dd.halftrack > 68 ? 68 : dd.halftrack)\n  } else {\n    passDriveSound(DRIVE.TRACK_SEEK)\n  }\n  passData()\n  // Adjust new track location based on arm position relative to old track loc.\n  if (dd.trackStart[dd.halftrack] > 0 && dd.prevHalfTrack !== dd.halftrack) {\n    // const oldloc = dState.trackLocation\n    dd.trackLocation = Math.floor(dd.trackLocation * (dd.trackNbits[dd.halftrack] / dd.trackNbits[dd.prevHalfTrack]))\n    if (dd.trackLocation > 3) {\n      dd.trackLocation -= 4\n    }\n  }\n}\n\nconst pickbit = [128, 64, 32, 16, 8, 4, 2, 1]\nconst clearbit = [0b01111111, 0b10111111, 0b11011111, 0b11101111,\n  0b11110111, 0b11111011, 0b11111101, 0b11111110]\n\nconst getNextBit = () => {\n  const dd = driveState[currentDrive]\n  dd.trackLocation = dd.trackLocation % dd.trackNbits[dd.halftrack]\n  let bit: number\n  if (dd.trackStart[dd.halftrack] > 0) {\n    const fileOffset = dd.trackStart[dd.halftrack] + (dd.trackLocation >> 3)\n    const byte = diskData[currentDrive][fileOffset]\n    const b = dd.trackLocation & 7\n    bit = (byte & pickbit[b]) >> (7 - b)\n  } else {\n    // TODO: Freak out like a MC3470 and return random bits\n    bit = 1\n  }\n  dd.trackLocation++\n  return bit\n}\n\nlet dataRegister = 0\n\nconst getNextByte = () => {\n  if (diskData[currentDrive].length === 0) return 0\n  let result = 0\n  if (dataRegister === 0) {\n    while (getNextBit() === 0) {}\n    // This will become the high bit on the next read\n    dataRegister = 0x40\n    // Read the next 6 bits, all except the last one.\n    for (let i = 5; i >= 0; i--) {\n      dataRegister |= getNextBit() << i\n    }\n  } else {\n    // Read the last bit.\n    const bit = getNextBit()\n    dataRegister = (dataRegister << 1) | bit\n  }\n  result = dataRegister\n  if (dataRegister > 127) {\n    dataRegister = 0\n  }\n  return result\n}\n\nlet prevCycleCount = 0\n\nconst doWriteBit = (bit: 0 | 1) => {\n  const dd = driveState[currentDrive]\n  dd.trackLocation = dd.trackLocation % dd.trackNbits[dd.halftrack]\n  // TODO: What about writing to empty tracks?\n  if (dd.trackStart[dd.halftrack] > 0) {\n    const fileOffset = dd.trackStart[dd.halftrack] + (dd.trackLocation >> 3)\n    let byte = diskData[currentDrive][fileOffset]\n    const b = dd.trackLocation & 7\n    if (bit) {\n      byte |= pickbit[b]\n    } else {\n      byte &= clearbit[b]\n    }\n    diskData[currentDrive][fileOffset] = byte\n  }\n  dd.trackLocation++\n}\n\nconst doWriteByte = (delta: number) => {\n  const dd = driveState[currentDrive]\n  // Sanity check to make sure we aren't on an empty track. Is this correct?\n  if (diskData[currentDrive].length === 0 || dd.trackStart[dd.halftrack] === 0) {\n    return\n  }\n  if (dataRegister > 0) {\n    if (delta >= 16) {\n      for (let i = 7; i >= 0; i--) {\n        doWriteBit(dataRegister & 2**i ? 1 : 0)      \n      }\n    }\n    if (delta >= 36) {\n      doWriteBit(0)\n    }\n    if (delta >= 40) {\n      doWriteBit(0)\n    }\n    debugCache.push(delta >= 40 ? 2 : delta >= 36 ? 1 : dataRegister)\n    dd.diskHasChanges = true\n    dataRegister = 0\n  }\n}\n\nconst doMotorTimeout = () => {\n  motorOffTimeout = 0\n  if (!SWITCHES.DRIVE.isSet) {\n    driveState[currentDrive].motorRunning = false\n  }\n  passData()\n  passDriveSound(DRIVE.MOTOR_OFF)\n}\n\nconst startMotor = () => {\n  if (motorOffTimeout) {\n    clearTimeout(motorOffTimeout)\n    motorOffTimeout = 0\n  }\n  driveState[currentDrive].motorRunning = true\n  passData()\n  passDriveSound(DRIVE.MOTOR_ON)\n}\n\nconst stopMotor = () => {\n  if (motorOffTimeout === 0) {\n    motorOffTimeout = setTimeout(() => doMotorTimeout(), 1000);\n  }\n}\n\nlet debugCache:number[] = []\nconst doDebugDrive = false\n\nconst dumpData = (addr: number) => {\n  // if (dataRegister !== 0) {\n  //   console.error(`addr=${toHex(addr)} writeByte= ${dataRegister}`)\n  // }\n  if (debugCache.length > 0 && driveState[currentDrive].halftrack === 2 * 0x00) {\n    if (doDebugDrive) {\n      let output = `TRACK ${toHex(driveState[currentDrive].halftrack/2)}: `\n      let out = ''\n      debugCache.forEach(element => {\n        switch (element) {\n          case 1: out = 'Ff'; break;\n          case 2: out = 'FF'; break;\n          default: out = element.toString(16); break;\n        }\n        output += out + ' '\n      });\n      console.log(output)\n    }\n    debugCache = []\n  }\n}\n\nexport const handleDriveSoftSwitches =\n  (addr: number, value: number): number => {\n  const dd = driveState[currentDrive]\n  let result = 0\n  const delta = cycleCount - prevCycleCount\n  // if (doDebugDrive && value !== 0x96) {\n  //   const dc = (delta < 100) ? `  deltaCycles=${delta}` : ''\n  //   const wb = (dataRegister > 0) ? `  writeByte=$${toHex(dataRegister)}` : ''\n  //   const v = (value > 0) ? `  value=$${toHex(value)}` : ''\n  //   console.log(`write ${dd.writeMode}  addr=$${toHex(addr)}${dc}${wb}${v}`)\n  // }\n  if (addr === SWITCHES.DRVDATA.offAddr) {  // $C08C SHIFT/READ\n    if (dd.motorRunning && !dd.writeMode) {\n      return getNextByte()\n    }\n  }\n  if (addr === SWITCHES.DRIVE.onAddr) {  // $C089\n    startMotor()\n    dumpData(addr)\n    return result\n  }\n  if (addr === SWITCHES.DRIVE.offAddr) {  // $C088\n    stopMotor()\n    dumpData(addr)\n    return result\n  }\n  if (addr === SWITCHES.DRVSEL.offAddr || addr === SWITCHES.DRVSEL.onAddr) {\n    currentDrive = (addr === SWITCHES.DRVSEL.offAddr) ? 0 : 1\n    if (driveState[1 - currentDrive].motorRunning) {\n      driveState[1 - currentDrive].motorRunning = false\n      driveState[currentDrive].motorRunning = true\n      for (let i = 0; i < driveState.length; i++) {\n        passData()\n      }\n    }\n    return result\n  }\n  const ps = [SWITCHES.DRVSM0, SWITCHES.DRVSM1,\n    SWITCHES.DRVSM2, SWITCHES.DRVSM3]\n  const a = addr - SWITCHES.DRVSM0.offAddr\n  // One of the stepper motors has been turned on or off\n  if (a >= 0 && a <= 7) {\n    const ascend = ps[(dd.currentPhase + 1) % 4]\n    const descend = ps[(dd.currentPhase + 3) % 4]\n    // Make sure our current phase motor has been turned off.\n    if (!ps[dd.currentPhase].isSet) {\n      if (dd.motorRunning && ascend.isSet) {\n        moveHead(1)\n        dd.currentPhase = (dd.currentPhase + 1) % 4\n\n      } else if (dd.motorRunning && descend.isSet) {\n        moveHead(-1)\n        dd.currentPhase = (dd.currentPhase + 3) % 4\n      }\n    }\n    // if (doDebugDrive) {\n    //   const phases = `${ps[0].isSet ? 1 : 0}${ps[1].isSet ? 1 : 0}` +\n    //     `${ps[2].isSet ? 1 : 0}${ps[3].isSet ? 1 : 0}`\n    //   console.log(`***** PC=${toHex(s6502.PC,4)}  addr=${toHex(addr,4)} ` +\n    //     `phase ${a >> 1} ${a % 2 === 0 ? \"off\" : \"on \"}  ${phases}  ` +\n    //     `track=${dState.halftrack / 2}`)\n    // }\n    dumpData(addr)\n  } else if (addr === SWITCHES.DRVWRITE.offAddr) {  // $C08E READ\n    if (dd.motorRunning && dd.writeMode) {\n      doWriteByte(delta)\n      // Reset the Disk II Logic State Sequencer clock\n      prevCycleCount = cycleCount\n    }\n    dd.writeMode = false\n    if (SWITCHES.DRVDATA.isSet) {\n      result = dd.isWriteProtected ? 0xFF : 0\n    }\n    dumpData(addr)\n  } else if (addr === SWITCHES.DRVWRITE.onAddr) {  // $C08F WRITE\n    dd.writeMode = true\n    // Reset the Disk II Logic State Sequencer clock\n    prevCycleCount = cycleCount\n    if (value >= 0) {\n      dataRegister = value\n    }\n  } else if (addr === SWITCHES.DRVDATA.onAddr) {  // $C08D LOAD/READ\n    if (dd.motorRunning) {\n      if (dd.writeMode) {\n        doWriteByte(delta)\n        // Reset the Disk II Logic State Sequencer clock\n        prevCycleCount = cycleCount\n      }\n      if (value >= 0) {\n        dataRegister = value\n      }\n    }\n  }\n\n  return result\n}\n\nexport const doSetDriveProps = (props: DriveProps) => {\n  driveState[props.drive] = initDriveState()\n  diskData[props.drive] = new Uint8Array()\n  driveState[props.drive].filename = props.filename\n  driveState[props.drive].motorRunning = props.motorRunning\n  if (props.diskData.length > 0) {\n    diskData[props.drive] = decodeDiskData(driveState[props.drive], props.diskData)\n  }\n  passData()\n}\n","import { SWITCHES, checkSoftSwitches } from \"./softswitches\";\nimport { cycleCount } from \"./instructions\"\nimport { handleDriveSoftSwitches } from \"./diskdata\"\nimport { romBase64 } from \"./roms/rom_2e\"\nimport { disk2driver } from \"./roms/slot_disk2_cx00\"\nimport { Buffer } from \"buffer\";\n\n// Bank1 of $D000-$DFFF is stored in mainMem (and auxMem) at 0xC000-0xCFFF\n// Bank2 of $D000-$DFFF is stored in mainMem (and auxMem) at 0xD000-0xDFFF\nexport let mainMem = new Uint8Array(65536)\nexport let auxMem = new Uint8Array(65536)\nexport let memC000 = new Uint8Array(256)\nconst empty = new Uint8Array(256).fill(255)\nlet slots = [\n  empty,\n  empty,\n  empty,\n  empty,\n  empty,\n  disk2driver,\n  empty,\n]\n\nexport const setSlotDriver = (slot: number, driver: Uint8Array) => {\n  slots[slot - 1] = driver\n}\n\nconst rom = new Uint8Array(\n  Buffer.from(romBase64.replaceAll(\"\\n\", \"\"), \"base64\")\n)\n\n// Set $C007: FF to see this code\n// Hack to change the cursor\n// rom[0xC26F - 0xC000] = 161\n// rom[0xC273 - 0xC000] = 161\n// Hack to speed up the cursor\n// rom[0xC288 - 0xC000] = 0x20\n\n// let nn = 0\n\nconst memGetSoftSwitch = (addr: number, code=0): number => {\n  // $C019 Vertical blanking status (0 = vertical blanking, 1 = beam on)\n  if (addr === 0xC019) {\n    // Return \"low\" for 70 scan lines out of 262 (70 * 65 cycles = 4550)\n    return ((cycleCount % 17030) > 12480) ? 0x0D : 0x8D\n  }\n  // if (code === 0xDD && addr === 0xC0EC) {\n  //   let t = performance.now()\n  //   for (let index = 0; index < nn; index++) {\n  //     checkSoftSwitches(addr, false, cycleCount)\n  //   }\n  //   let t1 = (performance.now() - t)\n  //   console.log(`checkSoftSwitches t=${t1}`)\n  //   t = performance.now()\n  //   let result = 0\n  //   for (let index = 0; index < nn; index++) {\n  //     if (addr >= SWITCHES.DRVSM0.offAddr && addr <= SWITCHES.DRVWRITE.onAddr) {\n  //       result = handleDriveSoftSwitches(addr, -1)\n  //     }\n  //   }\n  //   t1 = (performance.now() - t)\n  //   console.log(`handleDriveSoftSwitches t=${t1}`)\n  //   return result\n  // } else {\n    checkSoftSwitches(addr, false, cycleCount)\n    if (addr >= SWITCHES.DRVSM0.offAddr && addr <= SWITCHES.DRVWRITE.onAddr) {\n//      nn++\n//      console.log(`${nn}`)\n      return handleDriveSoftSwitches(addr, -1)\n    }\n//  }\n\n  return memC000[addr - 0xC000]\n}\n\nconst memGetBankC000 = (addr: number): number => {\n  if (SWITCHES.INTCXROM.isSet) {\n    return rom[addr - 0xC000]\n  }\n  // TODO: This should return the card's ROM, not regular ROM.\n  if (addr >= 0xC800) {\n    return rom[addr - 0xC000]\n  }\n  if ((addr >= 0xC300 && addr <= 0xC3FF) && !SWITCHES.SLOTC3ROM.isSet) {\n    return rom[addr - 0xC000]\n  }\n  const slot = Math.floor((addr - 0xC100) / 256)\n  return slots[slot][addr - 0xC100 - 256 * slot]\n}\n\nexport const memGet = (addr: number, code=0): number => {\n  if (addr >= 0xC000 && addr <= 0xC0FF) {\n    return memGetSoftSwitch(addr, code)\n  }\n  if (addr >= 0xC100 && addr <= 0xCFFF) {\n    return memGetBankC000(addr)\n  }\n  if (addr >= 0xD000) {\n    if (!SWITCHES.BSRREADRAM.isSet) {\n      return rom[addr - 0xC000]\n    }\n    // Bank1 of $D000-$DFFF is stored in $C000, so adjust address if necessary\n    if (addr <= 0xDFFF && !SWITCHES.BSRBANK2.isSet) {\n      addr -= 0x1000\n    }\n  }\n\n  let readAuxMem = SWITCHES.RAMRD.isSet\n\n  if (addr <= 0x1FF || addr >= 0xC000) {\n    readAuxMem = SWITCHES.ALTZP.isSet\n  } else if (addr >= 0x400 && addr <= 0x7FF) {\n    if (SWITCHES.STORE80.isSet) {\n      readAuxMem = SWITCHES.PAGE2.isSet\n    }\n  } else if (addr >= 0x2000 && addr <= 0x3FFF) {\n    if (SWITCHES.STORE80.isSet) {\n      if (SWITCHES.HIRES.isSet) {\n        readAuxMem = SWITCHES.PAGE2.isSet\n      }\n    }\n  }\n\n  return (readAuxMem ? auxMem[addr] : mainMem[addr])\n}\n\nexport const memSet = (addr: number, value: number) => {\n  if (addr >= 0xC000 && addr <= 0xC0FF) {\n    if (addr >= SWITCHES.DRVSM0.offAddr && addr <= SWITCHES.DRVWRITE.onAddr) {\n      handleDriveSoftSwitches(addr, value)\n    } else {\n      checkSoftSwitches(addr, true, cycleCount)\n    }\n    return\n  }\n  if (addr >= 0xC100 && addr <= 0xCFFF) {\n    return\n  }\n\n  if (addr >= 0xD000) {\n    const writeRAM = SWITCHES.WRITEBSR1.isSet || SWITCHES.WRITEBSR2.isSet ||\n      SWITCHES.RDWRBSR1.isSet || SWITCHES.RDWRBSR2.isSet\n    if (!writeRAM) {\n      return\n    }\n    // Bank1 of $D000-$DFFF is stored in $C000, so adjust address if necessary\n    if (addr <= 0xDFFF && !SWITCHES.BSRBANK2.isSet) {\n      addr -= 0x1000\n    }\n  }\n\n  let writeAuxMem = SWITCHES.RAMWRT.isSet\n\n  if (addr <= 0x1FF || addr >= 0xC000) {\n    writeAuxMem = SWITCHES.ALTZP.isSet\n  } else if (addr >= 0x400 && addr <= 0x7FF) {\n    if (SWITCHES.STORE80.isSet) {\n      writeAuxMem = SWITCHES.PAGE2.isSet\n    }\n  } else if (addr >= 0x2000 && addr <= 0x3FFF) {\n    if (SWITCHES.STORE80.isSet) {\n      if (SWITCHES.HIRES.isSet) {\n        writeAuxMem = SWITCHES.PAGE2.isSet\n      }\n    }\n  }\n\n  if (writeAuxMem) {\n    auxMem[addr] = value\n  } else {\n    mainMem[addr] = value\n  }\n}\n\nconst TEXT_PAGE1 = 0x400\nconst TEXT_PAGE2 = 0x800\nconst offset = [\n  0, 0x80, 0x100, 0x180, 0x200, 0x280, 0x300, 0x380, 0x28, 0xA8, 0x128, 0x1A8,\n  0x228, 0x2A8, 0x328, 0x3A8, 0x50, 0xD0, 0x150, 0x1D0, 0x250, 0x2D0, 0x350,\n  0x3D0,\n]\n\nexport function getTextPage(getLores = false) {\n  let jstart = 0\n  let jend = 24\n  let is80column = false\n  if (getLores) {\n    if (SWITCHES.TEXT.isSet || SWITCHES.HIRES.isSet) {\n      return new Uint8Array()\n    }\n    jend = SWITCHES.MIXED.isSet ? 20 : 24\n    is80column = SWITCHES.COLUMN80.isSet && !SWITCHES.AN3.isSet\n  } else {\n    if (!SWITCHES.TEXT.isSet && !SWITCHES.MIXED.isSet) {\n      return new Uint8Array()\n    }\n    if (!SWITCHES.TEXT.isSet && SWITCHES.MIXED.isSet) jstart = 20\n    is80column = SWITCHES.COLUMN80.isSet\n  }\n  if (is80column) {\n    // Only select second 80-column text page if STORE80 is also OFF\n    const pageOffset = (SWITCHES.PAGE2.isSet && !SWITCHES.STORE80.isSet) ? TEXT_PAGE2 : TEXT_PAGE1\n    const textPage = new Uint8Array(80 * (jend - jstart)).fill(0xA0)\n    for (let j = jstart; j < jend; j++) {\n      const joffset = 80 * (j - jstart)\n      for (let i = 0; i < 40; i++) {\n        textPage[joffset + 2 * i + 1] = mainMem[pageOffset + offset[j] + i]\n        textPage[joffset + 2 * i] = auxMem[pageOffset + offset[j] + i]\n      }\n    }\n    return textPage\n  } else {\n    const pageOffset = SWITCHES.PAGE2.isSet ? TEXT_PAGE2 : TEXT_PAGE1\n    const textPage = new Uint8Array(40 * (jend - jstart))\n    for (let j = jstart; j < jend; j++) {\n      const joffset = 40 * (j - jstart)\n      let start = pageOffset + offset[j]\n      textPage.set(mainMem.slice(start, start + 40), joffset)\n    }\n    return textPage\n  }\n}\n\nexport function getHires() {\n  if (SWITCHES.TEXT.isSet || !SWITCHES.HIRES.isSet) {\n    return new Uint8Array()\n  }\n  const doubleRes = SWITCHES.COLUMN80.isSet && !SWITCHES.AN3.isSet\n  const nlines = SWITCHES.MIXED.isSet ? 160 : 192\n  if (doubleRes) {\n    // Only select second 80-column text page if STORE80 is also OFF\n    const pageOffset = (SWITCHES.PAGE2.isSet && !SWITCHES.STORE80.isSet) ? 0x4000 : 0x2000\n    const hgrPage = new Uint8Array(80 * nlines)\n    for (let j = 0; j < nlines; j++) {\n      const addr = pageOffset + 40 * Math.trunc(j / 64) +\n        1024 * (j % 8) + 128 * (Math.trunc(j / 8) & 7)\n      for (let i = 0; i < 40; i++) {\n        hgrPage[j * 80 + 2 * i + 1] = mainMem[addr + i]\n        hgrPage[j * 80 + 2 * i] = auxMem[addr + i]\n      }\n    }\n    return hgrPage\n  } else {\n    const pageOffset = SWITCHES.PAGE2.isSet ? 0x4000 : 0x2000\n    const hgrPage = new Uint8Array(40 * nlines)\n    for (let j = 0; j < nlines; j++) {\n      const addr = pageOffset + 40 * Math.trunc(j / 64) +\n        1024 * (j % 8) + 128 * (Math.trunc(j / 8) & 7)\n      hgrPage.set(mainMem.slice(addr, addr + 40), j * 40)\n    }\n    return hgrPage\n  }\n}\n","export const disk2driver = [0xA2,0x20,0xA0,0x00,0xA2,0x03,0x86,0x3C,0x8A,0x0A,0x24,0x3C,0xF0,0x10,0x05,0x3C,0x49,0xFF,0x29,0x7E,0xB0,0x08,0x4A,0xD0,0xFB,0x98,0x9D,0x56,0x03,0xC8,0xE8,0x10,0xE5,0x20,0x58,0xFF,0xBA,0xBD,0x00,0x01,0x0A,0x0A,0x0A,0x0A,0x85,0x2B,0xAA,0xBD,0x8E,0xC0,0xBD,0x8C,0xC0,0xBD,0x8A,0xC0,0xBD,0x89,0xC0,0xA0,0x50,0xBD,0x80,0xC0,0x98,0x29,0x03,0x0A,0x05,0x2B,0xAA,0xBD,0x81,0xC0,0xA9,0x56,0x20,0xA8,0xFC,0x88,0x10,0xEB,0x85,0x26,0x85,0x3D,0x85,0x41,0xA9,0x08,0x85,0x27,0x18,0x08,0xBD,0x8C,0xC0,0x10,0xFB,0x49,0xD5,0xD0,0xF7,0xBD,0x8C,0xC0,0x10,0xFB,0xC9,0xAA,0xD0,0xF3,0xEA,0xBD,0x8C,0xC0,0x10,0xFB,0xC9,0x96,0xF0,0x09,0x28,0x90,0xDF,0x49,0xAD,0xF0,0x25,0xD0,0xD9,0xA0,0x03,0x85,0x40,0xBD,0x8C,0xC0,0x10,0xFB,0x2A,0x85,0x3C,0xBD,0x8C,0xC0,0x10,0xFB,0x25,0x3C,0x88,0xD0,0xEC,0x28,0xC5,0x3D,0xD0,0xBE,0xA5,0x40,0xC5,0x41,0xD0,0xB8,0xB0,0xB7,0xA0,0x56,0x84,0x3C,0xBC,0x8C,0xC0,0x10,0xFB,0x59,0xD6,0x02,0xA4,0x3C,0x88,0x99,0x00,0x03,0xD0,0xEE,0x84,0x3C,0xBC,0x8C,0xC0,0x10,0xFB,0x59,0xD6,0x02,0xA4,0x3C,0x91,0x26,0xC8,0xD0,0xEF,0xBC,0x8C,0xC0,0x10,0xFB,0x59,0xD6,0x02,0xD0,0x87,0xA0,0x00,0xA2,0x56,0xCA,0x30,0xFB,0xB1,0x26,0x5E,0x00,0x03,0x2A,0x5E,0x00,0x03,0x2A,0x91,0x26,0xC8,0xD0,0xEE,0xE6,0x27,0xE6,0x3D,0xA5,0x3D,0xCD,0x00,0x08,0xA6,0x2B,0x90,0xDB,0x4C,0x01,0x08,0x00,0x00,0x00,0x00,0x00]\n// export const slot_disk2=`oiCgAKIDhjyKCiQ88BAFPEn/KX6wCErQ+5idVgPI6BDlIFj/ur0AAQoKCgqFK6q9\n// jsC9jMC9isC9icCgUL2AwJgpAwoFK6q9gcCpViCo/IgQ64UmhT2FQakIhScYCL2M\n// wBD7SdXQ972MwBD7yarQ8+q9jMAQ+8mW8AkokN9JrfAl0NmgA4VAvYzAEPsqhTy9\n// jMAQ+yU8iNDsKMU90L6lQMVB0Liwt6BWhDy8jMAQ+1nWAqQ8iJkAA9DuhDy8jMAQ\n// +1nWAqQ8kSbI0O+8jMAQ+1nWAtCHoACiVsow+7EmXgADKl4AAyqRJsjQ7uYn5j2l\n// Pc0ACKYrkNtMAQgAAAAAAA==`\n","export const romBase64=`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\ncM5oYLEoLB/AEBmNAcCEKphFIGqwBK1VwMiYSqixKCxUwKQqLB7AEAbJILACCUBg\nSCn/MBat+wRqaEiQDiwewBAJSUAsrM7wAklALB/AEB2NAcBIhCqYRSBKsAStVcDI\nmEqoaJEorVTApCpoYJEoaGBImEisewUgRM6NewYpgEmrTM3OSJhIrHsFrXsGIHDO\naKhoYCBxzan/hTKt+wQpBPACRjKteweFKK37B4UprfsFhSVgLBLAED2pBs2z+/A2\nogMsEcAwAqILjbP7LIDArbP7yQbwAegsgcAsgcCgAKn4hTeENrE2kTbI0PnmN9D1\nvYDAvYDAYAAAAOmBStAUpD+mPtABiMqKGOU6hT4QAciY5TvQQKQvuT0AkTqIEPgg\nSPkgGvwgGvxM4/ylPSCO+Kq9APrFQtATvcD5xUPQDKVEpC7AnfCzxS7wysY90Nzm\nRMY18NakNJiqTNL8IMf/rQACyaDwEsmN0AFgIKf/yZPQ5Yrw4iB4/qkDhT0gE/8K\n6b7JwpDRCgqiBAomQiZDyhD4xj3w9BDkogUgyMSlRAoKBTXJILAGpjXwAgmAhUSE\nNLkAAsm78ATJjdC0TGvP32/YZdf43JTZsdsw89jf4duP85jz5PHd8dTxJPIx8kDy\n1/Ph8+j2/fZo92735vdX/CD3Jvd092zybvJy8nbyf/JO8mrZVfKF8qXyyvIX87vz\nnvNh8kXaPdkR2cjZSNj0AyDZatnb2W3Y69mD58jYr9gS43rn1NqV2KTWadaf20jW\nkOsj7K/rCgDe4hLUzd//4o3uru9B6Qnv6u/x7zrwnvBk59bmxeMH5+XmRuZa5obm\nkeZ5wOd5qed7gel7aOp9lu5QVN9GTt9/z+5/l95kZN9FTsRGT9JORVjUREFUwUlO\nUFXUREXMREnNUkVBxEfSVEVY1FBSo0lOo0NBTMxQTE/USExJzlZMSc5IR1KySEfS\nSENPTE9SvUhQTE/URFJB11hEUkHXSFRBwkhPTcVST1S9U0NBTEW9U0hMT0HEVFJB\nQ8VOT1RSQUPFTk9STUHMSU5WRVJTxUZMQVPIQ09MT1K9UE/QVlRBwkhJTUVNukxP\nTUVNuk9ORVLSUkVTVU3FUkVDQUzMU1RPUsVTUEVFRL1MRdRHT1TPUlXOScZSRVNU\nT1LFpkdPU1XCUkVUVVLOUkXNU1RP0E/OV0FJ1ExPQcRTQVbFREXGUE9LxVBSSU7U\nQ09O1ExJU9RDTEVB0kdF1E5F11RBQqhUz0bOU1BDqFRIRc5B1E5P1FNURdCrraqv\n3kFOxE/Svr28U0fOSU7UQULTVVPSRlLFU0NSTqhQRMxQT9NTUdJSTsRMT8dFWNBD\nT9NTSc5UQc5BVM5QRUXLTEXOU1RSpFZBzEFTw0NIUqRMRUZUpFJJR0hUpE1JRKQA\nTkVYVCBXSVRIT1VUIEZP0lNZTlRB2FJFVFVSTiBXSVRIT1VUIEdPU1XCT1VUIE9G\nIERBVMFJTExFR0FMIFFVQU5USVTZT1ZFUkZMT9dPVVQgT0YgTUVNT1LZVU5ERUYn\nRCBTVEFURU1FTtRCQUQgU1VCU0NSSVDUUkVESU0nRCBBUlJB2URJVklTSU9OIEJZ\nIFpFUs9JTExFR0FMIERJUkVD1FRZUEUgTUlTTUFUQ8hTVFJJTkcgVE9PIExPTsdG\nT1JNVUxBIFRPTyBDT01QTEXYQ0FOJ1QgQ09OVElOVcVVTkRFRidEIEZVTkNUSU/O\nIEVSUk9SBwAgSU4gAA1CUkVBSwcAuujo6Oi9AQHJgdAhpYbQCr0CAYWFvQMBhYbd\nAwHQB6WF3QIB8AeKGGkSqtDYYCDj04VthG44pZblm4VeqKWX5Zyq6JjwI6WWOOVe\nhZawA8aXOKWU5V6FlLAIxpWQBLGWkZSI0PmxlpGUxpfGlcrQ8mAKaTawNYVeuuRe\nkC5gxHCQKNAExW+QIkiiCZhItZPKEPoghOSi92iVnegw+mioaMRwkAbQBcVvsAFg\nok0k2BADTOnyIPvaIFrbvWDSSCBc2+hoEPUgg9apUKDTIDrbpHbI8AMgGe0g+9qi\n3SAu1Ya4hLlG2CCxAKrw7KL/hnaQBiBZ1UwF2KavhmmmsIZqIAzaIFnVhA8gGtaQ\nRKABsZuFX6VphV6lnIVhpZuI8ZsYZWmFaYVgpWpp/4Vq5ZyqOKWb5WmosAPoxmEY\nZV6QA8ZfGLFekWDI0PnmX+ZhytDyrQAC8Dilc6R0hW+EcKVphZZlD4WUpGqEl5AB\nyISVIJPTpVCkUY3+AYz/AaVtpG6FaYRqpA+5+wGIkZvQ+CBl1qVnpGiFXoRfGKAB\nsV7QC6Vpha+laoWwTDzUoATIsV7Q+8iYZV6qoACRXqVfaQDIkV6GXoVfkNKigIYz\nIGr94O+QAqLvqQCdAAKK8Au9/wEpf53/AcrQ9akAov+gAWAgDP0pf2CmuMqgBIQT\n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\n5opMi/4g+OaKTJX+IPjm4DCwE4bwqSwgwN4g+ObgMLAFhiyGLWBMmeEg7PHk8LAI\npfCFLIUthvCpxSDA3iD45uAwsOJgIOzxiqTwwCiw10wA+CAJ8oqkLMAosMqk8EwZ\n+CAJ8oqowCiwvKXwTCj4IPjmikxk+CD45sqKyRiwp0xb+yD45opJ/6rohvFgOJAY\nZvJgqf/QAqk/ogCFMobzYKl/okDQ9SBn3SBS56VQxW2lUeVusANMENSlUIVzhW+l\nUYV0hXBgIGfdIFLnpVDFc6VR5XSw4KVQxWmlUeVqkNalUIVppVGFakxs1qmrIMDe\npbiF9KW5hfU4ZtildYX2pXaF9yCm2UyY2YbepviG36V1hdqldoXbpXmF3KV6hd2l\n9IW4pfWFuaX2hXWl94V2ILcAID7ZTNLXpdqFdaXbhXal3IW4pd2FuabfmkzS10zJ\n3rD7pq+GaaawhmogDNogGtalm4VgpZyFYaksIMDeIAza5lDQAuZRIBrWpZvFYKWc\n5WGwAWCgALGbkWDmm9AC5pzmYNAC5mGlacWbpWrlnLDmpmGkYNAByoiGaoRpTPLU\nrVbArVPATED7rVTATDn7INn3oAOxm6qIsZvpAbAByoVQhlEgzf4gd/dMzf4g2fcg\n/f6gArGbxVDIsZvlUbADTBDUIHf3TP3+LFXALFLAqUDQCKkgLFTALFPAheatV8Ct\nUMCpAIUcpeaFG6AAhBqlHJEaIH70yND25hulGykf0O5gheKG4IThSCnAhSZKSgUm\nhSZohScKCgomJwomJwpmJqUnKR8F5oUnisAA8AWgI2kEyOkHsPuE5aq9ufSFMJhK\npeSFHLAoYCAR9KUcUSYlMFEmkSZgECOlMEqwBUnAhTBgiBACoCepwIUwhOWlHArJ\nwBAGpRxJf4UcYKUwCkmAMN2pgcjAKJDgoACw3Bil0SkE8CWpfyUwMSbQGebqqX8l\nMBARGKXRKQTwDrEmRRwlMNAC5upRJpEmpdFl0ykDyQJqsJIwMBilJyy59dAiBiaw\nGizN9PAFaR84sBJpI0ilJmmwsAJp8IUmaLACaR9mJmn8hSdgGKUnaQQsufXQ8wYm\nkBhp4BgsCPXwEqUmaVBJ8PACSfCFJqXmkAJp4GYmkNFIqQCF4IXhheJoSDjl4EiK\n5eGF07AKaEn/aQFIqQDl04XRhdVohdCF1GiF4IbhmBjl4pAESf9p/oXShOJm0zjl\n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\ng39dzLX8Fxf1A/sDYvr6ww==`\n","import { toHex, MODE } from \"./utility\"\nimport { memGet, memSet } from \"./memory\"\n// var startTime = performance.now()\n\nexport let s6502: STATE6502 = {\n  PStatus: 0,\n  PC: 0,\n  Accum: 0,\n  XReg: 0,\n  YReg: 0,\n  StackPtr: 0\n}\n\nexport let cycleCount = 0\n\nexport const setCycleCount = (cycles: number) => { cycleCount = cycles }\n\nexport const set6502State = (new6502: any) => {\n  s6502 = new6502\n}\n\nexport const reset6502 = () => {\n  s6502.Accum = 0\n  s6502.XReg = 0\n  s6502.YReg = 0\n  s6502.PStatus = 0b00100100\n  s6502.StackPtr = 0xFF\n  setPC(memGet(0xFFFD) * 256 + memGet(0xFFFC))\n}\n\nexport const incrementPC = (value: number) => {\n  setPC((s6502.PC + value + 65536) % 65536)\n}\n\nexport const setPC = (value: number) => {\n  console.assert(!isNaN(value), \"illegal PC\")\n  s6502.PC = value\n}\n\nconst setPStatus = (value: number) => {\n  s6502.PStatus = value | 0b00110000\n}\n\nexport const stack = new Array<string>(256).fill('')\n\nconst pushStack = (call: string, value: number) => {\n  stack[s6502.StackPtr] = call\n  memSet(0x100 + s6502.StackPtr, value)\n  s6502.StackPtr = (s6502.StackPtr + 255) % 256\n}\n\nconst popStack = () => {\n  s6502.StackPtr = (s6502.StackPtr + 1) % 256;\n  const value = memGet(0x100 + s6502.StackPtr);\n  if (isNaN(value)) {\n    throw new Error(\"illegal stack value\");\n  }\n  return value\n}\n\nexport const isCarry = () => { return ((s6502.PStatus & 0x01) !== 0); }\nconst setCarry = (set = true) => s6502.PStatus = set ? s6502.PStatus | 1 :\n  s6502.PStatus & 0b11111110\n\nconst isZero = () => { return ((s6502.PStatus & 0x02) !== 0); }\nconst setZero = (set = true) => s6502.PStatus = set ? s6502.PStatus | 2 :\n  s6502.PStatus & 0b11111101\n\n// const isInterrupt = () => { return ((PStatus & 0x04) !== 0); }\nexport const setInterrupt = (set = true) => s6502.PStatus = set ? s6502.PStatus | 4 :\n  s6502.PStatus & 0b11111011\n\nconst isDecimal = () => { return ((s6502.PStatus & 0x08) !== 0); }\nconst BCD = () => (isDecimal() ? 1 : 0)\nconst setDecimal = (set = true) => s6502.PStatus = set ? s6502.PStatus | 8 :\n  s6502.PStatus & 0b11110111\n\nexport const isBreak = () => { return ((s6502.PStatus & 0x10) !== 0); }\nconst setBreak = (set = true) => s6502.PStatus = set ? s6502.PStatus | 0x10 :\n  s6502.PStatus & 0b11101111\n\nconst isOverflow = () => { return ((s6502.PStatus & 0x40) !== 0); }\nconst setOverflow = (set = true) => s6502.PStatus = set ? s6502.PStatus | 0x40 :\n  s6502.PStatus & 0b10111111\n\nconst isNegative = () => { return ((s6502.PStatus & 0x80) !== 0); }\nconst setNegative = (set = true) => s6502.PStatus = set ? s6502.PStatus | 0x80 :\n  s6502.PStatus & 0b01111111\n\nconst checkStatus = (value: number) => {\n  setZero(value === 0);\n  setNegative(value >= 128);\n}\n\n// Return number of clock cycles taken\nexport const doBranch = (takeBranch: boolean, offset: number) => {\n  if (takeBranch) {\n    const oldPC = s6502.PC\n    incrementPC((offset > 127) ? (offset - 256) : offset)\n    return 3 + pageBoundary(oldPC, s6502.PC)\n  }\n  return 2\n}\n\nconst oneByteAdd = (value: number, offset: number) => (value + offset + 256) % 256\nconst address = (vLo: number, vHi: number) => (vHi*256 + vLo)\nconst twoByteAdd = (vLo: number, vHi: number, offset: number) => (vHi*256 + vLo + offset + 65536) % 65536\nconst pageBoundary = (addr1: number, addr2: number) => (((addr1 >> 8) !== (addr2 >> 8)) ? 1 : 0)\n\nexport const pcodes = new Array<PCodeInstr>(256)\n\nconst PCODE = (name: string, mode: MODE, pcode: number, PC: number, code: PCodeFunc) => {\n  console.assert(!pcodes[pcode], \"Duplicate instruction: \" + name + \" mode=\" + mode)\n  pcodes[pcode] = {name: name, pcode: pcode, mode: mode, PC: PC, execute: code}\n}\n\nconst doIndirectYinstruction = (vZP: number,\n  doInstruction: (addr: number) => void,\n  addBCD: boolean) => {\n  const vLo = memGet(vZP)\n  const vHi = memGet((vZP + 1) % 256)\n  const addr = twoByteAdd(vLo, vHi, s6502.YReg)\n  doInstruction(addr)\n  let cycles = 5 + pageBoundary(addr, address(vLo, vHi))\n  if (addBCD) cycles += BCD()\n  return cycles\n}\n\nconst doIndirectInstruction = (vZP: number,\n  doInstruction: (addr: number) => void,\n  addBCD: boolean) => {\n  const vLo = memGet(vZP)\n  const vHi = memGet((vZP + 1) % 256)\n  const addr = address(vLo, vHi)\n  doInstruction(addr)\n  let cycles = 5\n  if (addBCD) cycles += BCD()\n  return cycles\n}\n\n// 300: F8 18 B8 A9 BD 69 00 D8 00\nconst doADC_BCD = (value: number) => {\n  let ones = (s6502.Accum & 0x0F) + (value & 0x0F) + (isCarry() ? 1 : 0)\n  // Handle illegal BCD hex values by wrapping to \"tens\" digit\n  if (ones >= 0xA) {\n    ones += 6\n  }\n  let tmp = (s6502.Accum & 0xF0) + (value & 0xF0) + ones\n  // Pretend we're doing normal addition to set overflow flag\n  const bothPositive = (s6502.Accum <= 127 && value <= 127)\n  const bothNegative = (s6502.Accum >= 128 && value >= 128)\n  setOverflow((tmp & 0xFF) >= 128 ? bothPositive : bothNegative)\n  // Handle illegal BCD hex values by wrapping to \"hundreds\" digit\n  setCarry(tmp >= 0xA0)\n  if (isCarry()) {\n    tmp += 0x60\n  }\n  s6502.Accum = tmp & 0xFF\n  // Assume we're a 65c02 and set the zero flag properly.\n  // This doesn't happen on a 6502 for BCD mode.\n  checkStatus(s6502.Accum)\n}\n\nconst doADC_HEX = (value: number) => {\n  let tmp = s6502.Accum + value + (isCarry() ? 1 : 0)\n  setCarry(tmp >= 256)\n  tmp = tmp % 256\n  const bothPositive = (s6502.Accum <= 127 && value <= 127)\n  const bothNegative = (s6502.Accum >= 128 && value >= 128)\n  setOverflow(tmp >= 128 ? bothPositive : bothNegative)\n  s6502.Accum = tmp\n  checkStatus(s6502.Accum)\n}\n\nconst doADC = (addr: number) => {\n  if (isDecimal()) {\n    doADC_BCD(memGet(addr))\n  } else {\n    doADC_HEX(memGet(addr))\n  }\n}\n\nPCODE('ADC', MODE.IMM, 0x69, 2, (value) => {\n  if (BCD()) {doADC_BCD(value)} else {doADC_HEX(value)}; return 2 + BCD()})\nPCODE('ADC', MODE.ZP_REL, 0x65, 2, (vZP) => {doADC(vZP); return 3 + BCD()})\nPCODE('ADC', MODE.ZP_X, 0x75, 2, (vZP) =>\n  {doADC(oneByteAdd(vZP, s6502.XReg)); return 4 + BCD()})\nPCODE('ADC', MODE.ABS, 0x6D, 3, (vLo, vHi) =>\n  {doADC(address(vLo, vHi)); return 4 + BCD()})\nPCODE('ADC', MODE.ABS_X, 0x7D, 3, (vLo, vHi) =>\n  {const addr = twoByteAdd(vLo, vHi, s6502.XReg);\n  doADC(addr); return 4 + BCD() + pageBoundary(addr, address(vLo, vHi))})\nPCODE('ADC', MODE.ABS_Y, 0x79, 3, (vLo, vHi) =>\n  {const addr = twoByteAdd(vLo, vHi, s6502.YReg);\n  doADC(addr); return 4 + BCD() + pageBoundary(addr, address(vLo, vHi))})\nPCODE('ADC', MODE.IND_X, 0x61, 2, (vOffset) =>\n  {const vZP = oneByteAdd(vOffset, s6502.XReg);\n  doADC(address(memGet(vZP), memGet(vZP + 1))); return 6 + BCD()})\nPCODE('ADC', MODE.IND_Y, 0x71, 2, (vZP) => doIndirectYinstruction(vZP, doADC, true))\nPCODE('ADC', MODE.IND, 0x72, 2, (vZP) => doIndirectInstruction(vZP, doADC, true))\n\nconst doAND = (addr: number) => {\n  s6502.Accum &= memGet(addr)\n  checkStatus(s6502.Accum)}\nPCODE('AND', MODE.IMM, 0x29, 2, (value) => {s6502.Accum &= value; checkStatus(s6502.Accum); return 2})\nPCODE('AND', MODE.ZP_REL, 0x25, 2, (vZP) => {doAND(vZP); return 3})\nPCODE('AND', MODE.ZP_X, 0x35, 2, (vZP) => {doAND(oneByteAdd(vZP, s6502.XReg)); return 4})\nPCODE('AND', MODE.ABS, 0x2D, 3, (vLo, vHi) => {doAND(address(vLo, vHi)); return 4})\nPCODE('AND', MODE.ABS_X, 0x3D, 3, (vLo, vHi) => {const addr = twoByteAdd(vLo, vHi, s6502.XReg);\n  doAND(addr); return 4 + pageBoundary(addr, address(vLo, vHi))})\nPCODE('AND', MODE.ABS_Y, 0x39, 3, (vLo, vHi) => {const addr = twoByteAdd(vLo, vHi, s6502.YReg);\n  doAND(addr); return 4 + pageBoundary(addr, address(vLo, vHi))})\nPCODE('AND', MODE.IND_X, 0x21, 2, (vOffset) => {const vZP = oneByteAdd(vOffset, s6502.XReg);\n  doAND(address(memGet(vZP), memGet(vZP + 1))); return 6})\nPCODE('AND', MODE.IND_Y, 0x31, 2, (vZP) => doIndirectYinstruction(vZP, doAND, false))\nPCODE('AND', MODE.IND, 0x32, 2, (vZP) => doIndirectInstruction(vZP, doAND, false))\n\nconst doASL = (addr: number) => {\n  let v = memGet(addr)\n  memGet(addr)  // extra strobe of the address (Sather IIe p. 4-27)\n  setCarry((v & 128) === 128)\n  v = (v << 1) % 256\n  memSet(addr, v)\n  checkStatus(v)}\nPCODE('ASL', MODE.IMPLIED, 0x0A, 1, () => {setCarry((s6502.Accum & 128) === 128);\n  s6502.Accum = (s6502.Accum << 1) % 256; checkStatus(s6502.Accum); return 2})\nPCODE('ASL', MODE.ZP_REL, 0x06, 2, (vZP) => {doASL(vZP); return 5})\nPCODE('ASL', MODE.ZP_X, 0x16, 2, (vZP) => {doASL(oneByteAdd(vZP, s6502.XReg)); return 6})\nPCODE('ASL', MODE.ABS, 0x0E, 3, (vLo, vHi) => {doASL(address(vLo, vHi)); return 6})\nPCODE('ASL', MODE.ABS_X, 0x1E, 3, (vLo, vHi) => {const addr = twoByteAdd(vLo, vHi, s6502.XReg);\n  doASL(addr);\n  return 6 + pageBoundary(addr, address(vLo, vHi))})\n\nPCODE('BCC', MODE.ZP_REL, 0x90, 2, (value) => doBranch(!isCarry(), value))\nPCODE('BCS', MODE.ZP_REL, 0xB0, 2, (value) => doBranch(isCarry(), value))\nPCODE('BEQ', MODE.ZP_REL, 0xF0, 2, (value) => doBranch(isZero(), value))\nPCODE('BMI', MODE.ZP_REL, 0x30, 2, (value) => doBranch(isNegative(), value))\nPCODE('BNE', MODE.ZP_REL, 0xD0, 2, (value) => doBranch(!isZero(), value))\nPCODE('BPL', MODE.ZP_REL, 0x10, 2, (value) => doBranch(!isNegative(), value))\nPCODE('BVC', MODE.ZP_REL, 0x50, 2, (value) => doBranch(!isOverflow(), value))\nPCODE('BVS', MODE.ZP_REL, 0x70, 2, (value) => doBranch(isOverflow(), value))\nPCODE('BRA', MODE.ZP_REL, 0x80, 2, (value) => doBranch(true, value))\n\nconst doBit = (value: number) => {\n  setZero((s6502.Accum & value) === 0);\n  setNegative((value & 0b10000000) !== 0);\n  setOverflow((value & 0b01000000) !== 0);\n}\nPCODE('BIT', MODE.ZP_REL, 0x24, 2, (vZP) => {doBit(memGet(vZP)); return 3})\nPCODE('BIT', MODE.ABS, 0x2C, 3, (vLo, vHi) => {doBit(memGet(address(vLo, vHi))); return 4})\nPCODE('BIT', MODE.IMM, 0x89, 2, (value) => {doBit(value); return 2})\nPCODE('BIT', MODE.ZP_X, 0x34, 2, (vZP) => {doBit(memGet(oneByteAdd(vZP, s6502.XReg))); return 4})\nPCODE('BIT', MODE.ABS_X, 0x3C, 3, (vLo, vHi) => {const addr = twoByteAdd(vLo, vHi, s6502.XReg);\n  doBit(memGet(addr)); return 4 + pageBoundary(addr, address(vLo, vHi))})\n\nPCODE('BRK', MODE.IMPLIED, 0x00, 1, () => {\n  setBreak();\n  memSet(0xC00A, 0)\n  memSet(0xC006, 0)\n  const PC2 = (s6502.PC + 2) % 65536\n  const vLo = memGet(0xFFFE)\n  const vHi = memGet(0xFFFF)\n  pushStack(\"BRK $\" + toHex(vHi) + toHex(vLo), Math.trunc(PC2 / 256))\n  pushStack(\"BRK\", PC2 % 256)\n  pushStack(\"S\", s6502.PStatus)\n  setDecimal(false)  // 65c02 only\n  setInterrupt()\n  setPC(twoByteAdd(vLo, vHi, -1));\n  return 7})\n\nPCODE('CLC', MODE.IMPLIED, 0x18, 1, () => {setCarry(false); return 2})\nPCODE('CLD', MODE.IMPLIED, 0xD8, 1, () => {setDecimal(false); return 2})\nPCODE('CLI', MODE.IMPLIED, 0x58, 1, () => {setInterrupt(false); return 2})\nPCODE('CLV', MODE.IMPLIED, 0xB8, 1, () => {setOverflow(false); return 2})\n\nconst doCMP = (addr: number) => {\n  const value = memGet(addr)\n  setCarry(s6502.Accum >= value)\n  checkStatus((s6502.Accum - value + 256) % 256)\n}\nconst doCMP1 = (addr: number) => {\n  const value = memGet(addr)\n  setCarry(s6502.Accum >= value)\n  checkStatus((s6502.Accum - value + 256) % 256)\n}\nPCODE('CMP', MODE.IMM, 0xC9, 2, (value) => {setCarry(s6502.Accum >= value);\n  checkStatus((s6502.Accum - value + 256) % 256); return 2})\nPCODE('CMP', MODE.ZP_REL, 0xC5, 2, (vZP) => {doCMP(vZP); return 3})\nPCODE('CMP', MODE.ZP_X, 0xD5, 2, (vZP) => {doCMP(oneByteAdd(vZP, s6502.XReg)); return 4})\nPCODE('CMP', MODE.ABS, 0xCD, 3, (vLo, vHi) => {doCMP(address(vLo, vHi)); return 4})\nPCODE('CMP', MODE.ABS_X, 0xDD, 3, (vLo, vHi) => {const addr = twoByteAdd(vLo, vHi, s6502.XReg);\n  doCMP1(addr); return 4 + pageBoundary(addr, address(vLo, vHi))})\nPCODE('CMP', MODE.ABS_Y, 0xD9, 3, (vLo, vHi) => {const addr = twoByteAdd(vLo, vHi, s6502.YReg);\n  doCMP(addr); return 4 + pageBoundary(addr, address(vLo, vHi))})\nPCODE('CMP', MODE.IND_X, 0xC1, 2, (vOffset) => {const vZP = oneByteAdd(vOffset, s6502.XReg);\n  doCMP(address(memGet(vZP), memGet(vZP + 1))); return 6})\nPCODE('CMP', MODE.IND_Y, 0xD1, 2, (vZP) => doIndirectYinstruction(vZP, doCMP, false))\nPCODE('CMP', MODE.IND, 0xD2, 2, (vZP) => doIndirectInstruction(vZP, doCMP, false))\n\nconst doCPX = (addr: number) => {\n  const value = memGet(addr)\n  setCarry(s6502.XReg >= value)\n  checkStatus((s6502.XReg - value + 256) % 256)\n}\nPCODE('CPX', MODE.IMM, 0xE0, 2, (value) => {setCarry(s6502.XReg >= value);\n  checkStatus((s6502.XReg - value + 256) % 256); return 2})\nPCODE('CPX', MODE.ZP_REL, 0xE4, 2, (vZP) => {doCPX(vZP); return 3})\nPCODE('CPX', MODE.ABS, 0xEC, 3, (vLo, vHi) => {doCPX(address(vLo, vHi)); return 4})\n\nconst doCPY = (addr: number) => {\n  const value = memGet(addr)\n  setCarry(s6502.YReg >= value)\n  checkStatus((s6502.YReg - value + 256) % 256)\n}\nPCODE('CPY', MODE.IMM, 0xC0, 2, (value) => {setCarry(s6502.YReg >= value);\n  checkStatus((s6502.YReg - value + 256) % 256); return 2})\nPCODE('CPY', MODE.ZP_REL, 0xC4, 2, (vZP) => {doCPY(vZP); return 3})\nPCODE('CPY', MODE.ABS, 0xCC, 3, (vLo, vHi) => {doCPY(address(vLo, vHi)); return 4})\n\nconst doDEC = (addr: number) => {\n  const v = oneByteAdd(memGet(addr), -1)\n  memSet(addr, v)\n  checkStatus(v)\n}\nPCODE('DEC', MODE.IMPLIED, 0x3A, 1, () => {s6502.Accum = oneByteAdd(s6502.Accum, -1);\n  checkStatus(s6502.Accum); return 2})\nPCODE('DEC', MODE.ZP_REL, 0xC6, 2, (vZP) => {doDEC(vZP); return 5})\nPCODE('DEC', MODE.ZP_X, 0xD6, 2, (vZP) => {doDEC(oneByteAdd(vZP, s6502.XReg)); return 6})\nPCODE('DEC', MODE.ABS, 0xCE, 3, (vLo, vHi) => {doDEC(address(vLo, vHi)); return 6})\nPCODE('DEC', MODE.ABS_X, 0xDE, 3, (vLo, vHi) => {\n  const addr = twoByteAdd(vLo, vHi, s6502.XReg)\n  memGet(addr)  // extra strobe of the address (Sather IIe p. 4-27)\n  doDEC(addr)\n  return 7})\n\nPCODE('DEX', MODE.IMPLIED, 0xCA, 1, () => {s6502.XReg = oneByteAdd(s6502.XReg, -1);\n  checkStatus(s6502.XReg); return 2})\nPCODE('DEY', MODE.IMPLIED, 0x88, 1, () => {s6502.YReg = oneByteAdd(s6502.YReg, -1);\n  checkStatus(s6502.YReg); return 2})\n\nconst doEOR = (addr: number) => {\n  s6502.Accum ^= memGet(addr)\n  checkStatus(s6502.Accum)\n}\nPCODE('EOR', MODE.IMM, 0x49, 2, (value) => {s6502.Accum ^= value; checkStatus(s6502.Accum); return 2})\nPCODE('EOR', MODE.ZP_REL, 0x45, 2, (vZP) => {doEOR(vZP); return 3})\nPCODE('EOR', MODE.ZP_X, 0x55, 2, (vZP) => {doEOR(oneByteAdd(vZP, s6502.XReg)); return 4})\nPCODE('EOR', MODE.ABS, 0x4D, 3, (vLo, vHi) => {doEOR(address(vLo, vHi)); return 4})\nPCODE('EOR', MODE.ABS_X, 0x5D, 3, (vLo, vHi) => {const addr = twoByteAdd(vLo, vHi, s6502.XReg);\n  doEOR(addr); return 4 + pageBoundary(addr, address(vLo, vHi))})\nPCODE('EOR', MODE.ABS_Y, 0x59, 3, (vLo, vHi) => {const addr = twoByteAdd(vLo, vHi, s6502.YReg);\n  doEOR(addr); return 4 + pageBoundary(addr, address(vLo, vHi))})\nPCODE('EOR', MODE.IND_X, 0x41, 2, (vOffset) => {const vZP = oneByteAdd(vOffset, s6502.XReg);\n  doEOR(address(memGet(vZP), memGet(vZP + 1))); return 6})\nPCODE('EOR', MODE.IND_Y, 0x51, 2, (vZP) => doIndirectYinstruction(vZP, doEOR, false))\nPCODE('EOR', MODE.IND, 0x52, 2, (vZP) => doIndirectInstruction(vZP, doEOR, false))\n\nconst doINC = (addr: number) => {\n  const v = oneByteAdd(memGet(addr), 1)\n  memSet(addr, v)\n  checkStatus(v)\n}\nPCODE('INC', MODE.IMPLIED, 0x1A, 1, () => {s6502.Accum = oneByteAdd(s6502.Accum, 1);\n  checkStatus(s6502.Accum); return 2})\nPCODE('INC', MODE.ZP_REL, 0xE6, 2, (vZP) => {doINC(vZP); return 5})\nPCODE('INC', MODE.ZP_X, 0xF6, 2, (vZP) => {doINC(oneByteAdd(vZP, s6502.XReg)); return 6})\nPCODE('INC', MODE.ABS, 0xEE, 3, (vLo, vHi) => {doINC(address(vLo, vHi)); return 6})\nPCODE('INC', MODE.ABS_X, 0xFE, 3, (vLo, vHi) => {\n  const addr = twoByteAdd(vLo, vHi, s6502.XReg)\n  memGet(addr)  // extra strobe of the address (Sather IIe p. 4-27)\n  doINC(addr)\n  return 7})\n\nPCODE('INX', MODE.IMPLIED, 0xE8, 1, () => {s6502.XReg = oneByteAdd(s6502.XReg, 1);\n  checkStatus(s6502.XReg); return 2})\nPCODE('INY', MODE.IMPLIED, 0xC8, 1, () => {s6502.YReg = oneByteAdd(s6502.YReg, 1);\n  checkStatus(s6502.YReg); return 2})\n\nPCODE('JMP', MODE.ABS, 0x4C, 3, (vLo, vHi) => {setPC(twoByteAdd(vLo, vHi, -3)); return 3})\n// 65c02 - this fixes the 6502 indirect JMP bug across page boundaries\nPCODE('JMP', MODE.IND, 0x6C, 3, (vLo, vHi) => {const a = address(vLo, vHi);\n  vLo = memGet(a); vHi = memGet((a + 1) % 65536); setPC(twoByteAdd(vLo, vHi, -3)); return 6})\nPCODE('JMP', MODE.IND_X, 0x7C, 3, (vLo, vHi) => {const a = twoByteAdd(vLo, vHi, s6502.XReg);\n  vLo = memGet(a); vHi = memGet((a + 1) % 65536); setPC(twoByteAdd(vLo, vHi, -3)); return 6})\n\nPCODE('JSR', MODE.ABS, 0x20, 3, (vLo, vHi) => {\n  // Push the (address - 1) of the next instruction\n  const PC2 = (s6502.PC + 2) % 65536\n  pushStack(\"JSR $\" + toHex(vHi) + toHex(vLo), Math.trunc(PC2 / 256));\n  pushStack(\"JSR\", PC2 % 256);\n  setPC(twoByteAdd(vLo, vHi, -3)); return 6})\n\nconst doLDA = (addr: number) => {\n  s6502.Accum = memGet(addr)\n  checkStatus(s6502.Accum)\n}\nPCODE('LDA', MODE.IMM, 0xA9, 2, (value) => {s6502.Accum = value; checkStatus(s6502.Accum); return 2})\nPCODE('LDA', MODE.ZP_REL, 0xA5, 2, (vZP) => {doLDA(vZP); return 3})\nPCODE('LDA', MODE.ZP_X, 0xB5, 2, (vZP) => {doLDA(oneByteAdd(vZP, s6502.XReg)); return 4})\nPCODE('LDA', MODE.ABS, 0xAD, 3, (vLo, vHi) => {doLDA(address(vLo, vHi)); return 4})\nPCODE('LDA', MODE.ABS_X, 0xBD, 3, (vLo, vHi) => {const addr = twoByteAdd(vLo, vHi, s6502.XReg);\n  doLDA(addr); return 4 + pageBoundary(addr, address(vLo, vHi))})\nPCODE('LDA', MODE.ABS_Y, 0xB9, 3, (vLo, vHi) => {const addr = twoByteAdd(vLo, vHi, s6502.YReg);\n  doLDA(addr); return 4 + pageBoundary(addr, address(vLo, vHi))})\nPCODE('LDA', MODE.IND_X, 0xA1, 2, (vOffset) => {const vZP = oneByteAdd(vOffset, s6502.XReg);\n  doLDA(address(memGet(vZP), memGet((vZP + 1) % 256))); return 6})\nPCODE('LDA', MODE.IND_Y, 0xB1, 2, (vZP) => doIndirectYinstruction(vZP, doLDA, false))\nPCODE('LDA', MODE.IND, 0xB2, 2, (vZP) => doIndirectInstruction(vZP, doLDA, false))\n\nconst doLDX = (addr: number) => {\n  s6502.XReg = memGet(addr)\n  checkStatus(s6502.XReg)\n}\nPCODE('LDX', MODE.IMM, 0xA2, 2, (value) => {s6502.XReg = value; checkStatus(s6502.XReg); return 2})\nPCODE('LDX', MODE.ZP_REL, 0xA6, 2, (vZP) => {doLDX(vZP); return 3})\nPCODE('LDX', MODE.ZP_Y, 0xB6, 2, (vZP) => {doLDX(oneByteAdd(vZP, s6502.YReg)); return 4})\nPCODE('LDX', MODE.ABS, 0xAE, 3, (vLo, vHi) => {doLDX(address(vLo, vHi)); return 4})\nPCODE('LDX', MODE.ABS_Y, 0xBE, 3, (vLo, vHi) => {const addr = twoByteAdd(vLo, vHi, s6502.YReg);\n  doLDX(addr); return 4 + pageBoundary(addr, address(vLo, vHi))})\n\nconst doLDY = (addr: number) => {\n  s6502.YReg = memGet(addr)\n  checkStatus(s6502.YReg)\n}\nPCODE('LDY', MODE.IMM, 0xA0, 2, (value) => {s6502.YReg = value; checkStatus(s6502.YReg); return 2})\nPCODE('LDY', MODE.ZP_REL, 0xA4, 2, (vZP) => {doLDY(vZP); return 3})\nPCODE('LDY', MODE.ZP_X, 0xB4, 2, (vZP) => {doLDY(oneByteAdd(vZP, s6502.XReg)); return 4})\nPCODE('LDY', MODE.ABS, 0xAC, 3, (vLo, vHi) => {doLDY(address(vLo, vHi)); return 4})\nPCODE('LDY', MODE.ABS_X, 0xBC, 3, (vLo, vHi) => {const addr = twoByteAdd(vLo, vHi, s6502.XReg);\n  doLDY(addr); return 4 + pageBoundary(addr, address(vLo, vHi))})\n\nconst doLSR = (addr: number) => {\n  let v = memGet(addr)\n  memGet(addr)  // extra strobe of the address (Sather IIe p. 4-27)\n  setCarry((v & 1) === 1)\n  v >>= 1\n  memSet(addr, v)\n  checkStatus(v)}\nPCODE('LSR', MODE.IMPLIED, 0x4A, 1, () => {setCarry((s6502.Accum & 1) === 1);\n  s6502.Accum >>= 1; checkStatus(s6502.Accum); return 2})\nPCODE('LSR', MODE.ZP_REL, 0x46, 2, (vZP) => {doLSR(vZP); return 5})\nPCODE('LSR', MODE.ZP_X, 0x56, 2, (vZP) => {doLSR(oneByteAdd(vZP, s6502.XReg)); return 6})\nPCODE('LSR', MODE.ABS, 0x4E, 3, (vLo, vHi) => {doLSR(address(vLo, vHi)); return 6})\nPCODE('LSR', MODE.ABS_X, 0x5E, 3, (vLo, vHi) => {const addr = twoByteAdd(vLo, vHi, s6502.XReg);\n  doLSR(addr);\n  return 6 + pageBoundary(addr, address(vLo, vHi))})\n\nPCODE('NOP', MODE.IMPLIED, 0xEA, 1, () => {return 2})\n\n// Undocumented 65c02 1-cycle NOP\nPCODE('NOP', MODE.IMPLIED, 0xEB, 1, () => {return 1})\n\nconst doORA = (addr: number) => {\n  s6502.Accum |= memGet(addr)\n  checkStatus(s6502.Accum)\n}\nPCODE('ORA', MODE.IMM, 0x09, 2, (value) => {s6502.Accum |= value; checkStatus(s6502.Accum); return 2})\nPCODE('ORA', MODE.ZP_REL, 0x05, 2, (vZP) => {doORA(vZP); return 3})\nPCODE('ORA', MODE.ZP_X, 0x15, 2, (vZP) => {doORA(oneByteAdd(vZP, s6502.XReg)); return 4})\nPCODE('ORA', MODE.ABS, 0x0D, 3, (vLo, vHi) => {doORA(address(vLo, vHi)); return 4})\nPCODE('ORA', MODE.ABS_X, 0x1D, 3, (vLo, vHi) => {const addr = twoByteAdd(vLo, vHi, s6502.XReg);\n  doORA(addr); return 4 + pageBoundary(addr, address(vLo, vHi))})\nPCODE('ORA', MODE.ABS_Y, 0x19, 3, (vLo, vHi) => {const addr = twoByteAdd(vLo, vHi, s6502.YReg);\n  doORA(addr); return 4 + pageBoundary(addr, address(vLo, vHi))})\nPCODE('ORA', MODE.IND_X, 0x01, 2, (vOffset) => {const vZP = oneByteAdd(vOffset, s6502.XReg);\n  doORA(address(memGet(vZP), memGet(vZP + 1))); return 6})\nPCODE('ORA', MODE.IND_Y, 0x11, 2, (vZP) => doIndirectYinstruction(vZP, doORA, false))\nPCODE('ORA', MODE.IND, 0x12, 2, (vZP) => doIndirectInstruction(vZP, doORA, false))\n\nPCODE('PHA', MODE.IMPLIED, 0x48, 1, () => {pushStack(\"A\", s6502.Accum); return 3})\nPCODE('PHP', MODE.IMPLIED, 0x08, 1, () => {setBreak(); pushStack(\"S\", s6502.PStatus); return 3})\nPCODE('PHX', MODE.IMPLIED, 0xDA, 1, () => {pushStack(\"X\", s6502.XReg); return 3})\nPCODE('PHY', MODE.IMPLIED, 0x5A, 1, () => {pushStack(\"Y\", s6502.YReg); return 3})\nPCODE('PLA', MODE.IMPLIED, 0x68, 1, () => {s6502.Accum = popStack(); checkStatus(s6502.Accum); return 4})\nPCODE('PLP', MODE.IMPLIED, 0x28, 1, () => {setPStatus(popStack()); return 4})\nPCODE('PLX', MODE.IMPLIED, 0xFA, 1, () => {s6502.XReg = popStack(); checkStatus(s6502.XReg); return 4})\nPCODE('PLY', MODE.IMPLIED, 0x7A, 1, () => {s6502.YReg = popStack(); checkStatus(s6502.YReg); return 4})\n\nconst doROL = (addr: number) => {\n  let v = memGet(addr)\n  memGet(addr)  // extra strobe of the address (Sather IIe p. 4-27)\n  const bit0 = isCarry() ? 1 : 0;\n  setCarry((v & 128) === 128)\n  v = ((v << 1) % 256) | bit0\n  memSet(addr, v)\n  checkStatus(v)}\nPCODE('ROL', MODE.IMPLIED, 0x2A, 1, () => {const bit0 = isCarry() ? 1 : 0;\n  setCarry((s6502.Accum & 128) === 128);\n  s6502.Accum = ((s6502.Accum << 1) % 256) | bit0; checkStatus(s6502.Accum); return 2})\nPCODE('ROL', MODE.ZP_REL, 0x26, 2, (vZP) => {doROL(vZP); return 5})\nPCODE('ROL', MODE.ZP_X, 0x36, 2, (vZP) => {doROL(oneByteAdd(vZP, s6502.XReg)); return 6})\nPCODE('ROL', MODE.ABS, 0x2E, 3, (vLo, vHi) => {doROL(address(vLo, vHi)); return 6})\nPCODE('ROL', MODE.ABS_X, 0x3E, 3, (vLo, vHi) => {const addr = twoByteAdd(vLo, vHi, s6502.XReg);\n  doROL(addr);\n  return 6 + pageBoundary(addr, address(vLo, vHi))})\n\nconst doROR = (addr: number) => {\n  let v = memGet(addr)\n  memGet(addr)  // extra strobe of the address (Sather IIe p. 4-27)\n  const bit7 = isCarry() ? 128 : 0;\n  setCarry((v & 1) === 1)\n  v = (v >> 1) | bit7\n  memSet(addr, v)\n  checkStatus(v)}\nPCODE('ROR', MODE.IMPLIED, 0x6A, 1, () => {const bit7 = isCarry() ? 128 : 0;\n  setCarry((s6502.Accum & 1) === 1);\n  s6502.Accum = (s6502.Accum >> 1) | bit7; checkStatus(s6502.Accum); return 2})\nPCODE('ROR', MODE.ZP_REL, 0x66, 2, (vZP) => {doROR(vZP); return 5})\nPCODE('ROR', MODE.ZP_X, 0x76, 2, (vZP) => {doROR(oneByteAdd(vZP, s6502.XReg)); return 6})\nPCODE('ROR', MODE.ABS, 0x6E, 3, (vLo, vHi) => {doROR(address(vLo, vHi)); return 6})\nPCODE('ROR', MODE.ABS_X, 0x7E, 3, (vLo, vHi) => {const addr = twoByteAdd(vLo, vHi, s6502.XReg);\n  doROR(addr);\n  return 6 + pageBoundary(addr, address(vLo, vHi))})\n\nPCODE('RTI', MODE.IMPLIED, 0x40, 1, () => {\n  setPStatus(popStack());\n  setPC(address(popStack(), popStack()) - 1); return 6})\n\nPCODE('RTS', MODE.IMPLIED, 0x60, 1, () => {setPC(address(popStack(), popStack())); return 6})\n\n// 300: F8 38 B8 A9 00 E9 00 D8 00\nconst doSBC_BCD = (value: number) => {\n  // On 65c02, do normal hex subtraction to set the carry & overflow flags.\n  const vtmp = 255 - value\n  let tmp = s6502.Accum + vtmp + (isCarry() ? 1 : 0)\n  const newCarry = (tmp >= 256)\n  const bothPositive = (s6502.Accum <= 127 && vtmp <= 127)\n  const bothNegative = (s6502.Accum >= 128 && vtmp >= 128)\n  setOverflow((tmp % 256) >= 128 ? bothPositive : bothNegative)\n\n  let ones = (s6502.Accum & 0x0F) - (value & 0x0F) + (isCarry() ? 0 : -1)\n  tmp = s6502.Accum - value + (isCarry() ? 0 : -1)\n  if (tmp < 0) {\n    tmp -= 0x60\n  }\n  if (ones < 0) {\n    tmp -= 0x06\n  }\n  s6502.Accum = tmp & 0xFF\n  // Assume we're a 65c02 and set the zero flag properly.\n  // This doesn't happen on a 6502 for BCD mode.\n  checkStatus(s6502.Accum)\n  setCarry(newCarry)\n}\n\nconst doSBC = (addr: number) => {\n  if (BCD()) {\n    doSBC_BCD(memGet(addr))\n  } else {\n    doADC_HEX(255 - memGet(addr))\n  }\n}\n\nPCODE('SBC', MODE.IMM, 0xE9, 2, (value) => {\n  if (BCD()) {doSBC_BCD(value)} else {doADC_HEX(255 - value)}\n  return 2 + BCD()})\nPCODE('SBC', MODE.ZP_REL, 0xE5, 2, (vZP) =>\n  {doSBC(vZP); return 3 + BCD()})\nPCODE('SBC', MODE.ZP_X, 0xF5, 2, (vZP) =>\n  {doSBC(oneByteAdd(vZP, s6502.XReg)); return 4 + BCD()})\nPCODE('SBC', MODE.ABS, 0xED, 3, (vLo, vHi) =>\n  {doSBC(address(vLo, vHi)); return 4 + BCD()})\nPCODE('SBC', MODE.ABS_X, 0xFD, 3, (vLo, vHi) =>\n  {const addr = twoByteAdd(vLo, vHi, s6502.XReg);\n  doSBC(addr); return 4 + BCD() + pageBoundary(addr, address(vLo, vHi))})\nPCODE('SBC', MODE.ABS_Y, 0xF9, 3, (vLo, vHi) =>\n  {const addr = twoByteAdd(vLo, vHi, s6502.YReg);\n  doSBC(addr); return 4 + BCD() + pageBoundary(addr, address(vLo, vHi))})\nPCODE('SBC', MODE.IND_X, 0xE1, 2, (vOffset) =>\n  {const vZP = oneByteAdd(vOffset, s6502.XReg);\n  doSBC(address(memGet(vZP), memGet(vZP + 1))); return 6 + BCD()})\nPCODE('SBC', MODE.IND_Y, 0xF1, 2, (vZP) =>\n  doIndirectYinstruction(vZP, doSBC, true))\nPCODE('SBC', MODE.IND, 0xF2, 2, (vZP) =>\n  doIndirectInstruction(vZP, doSBC, true))\n\nPCODE('SEC', MODE.IMPLIED, 0x38, 1, () => {setCarry(); return 2})\nPCODE('SED', MODE.IMPLIED, 0xF8, 1, () => {setDecimal(); return 2})\nPCODE('SEI', MODE.IMPLIED, 0x78, 1, () => {setInterrupt(); return 2})\n\n// Zero Page     STA $44       $85  2   3\n// Zero Page,X   STA $44,X     $95  2   4\n// Absolute      STA $4400     $8D  3   4\n// Absolute,X    STA $4400,X   $9D  3   5\n// Absolute,Y    STA $4400,Y   $99  3   5\n// Indirect,X    STA ($44,X)   $81  2   6\n// Indirect,Y    STA ($44),Y   $91  2   6\nPCODE('STA', MODE.ZP_REL, 0x85, 2, (vZP) => {memSet(vZP, s6502.Accum); return 3})\nPCODE('STA', MODE.ZP_X, 0x95, 2, (vZP) => {memSet(oneByteAdd(vZP, s6502.XReg), s6502.Accum); return 4})\nPCODE('STA', MODE.ABS, 0x8D, 3, (vLo, vHi) => {memSet(address(vLo, vHi), s6502.Accum); return 4})\nPCODE('STA', MODE.ABS_X, 0x9D, 3, (vLo, vHi) => {\n  const addr = twoByteAdd(vLo, vHi, s6502.XReg)\n  memGet(addr)  // extra strobe of the address (Sather IIe p. 4-27)\n  memSet(addr, s6502.Accum)\n  return 5})\nPCODE('STA', MODE.ABS_Y, 0x99, 3, (vLo, vHi) => {memSet(twoByteAdd(vLo, vHi, s6502.YReg), s6502.Accum); return 5})\nPCODE('STA', MODE.IND_X, 0x81, 2, (vOffset) => {const vZP = oneByteAdd(vOffset, s6502.XReg);\n  memSet(address(memGet(vZP), memGet(vZP + 1)), s6502.Accum); return 6})\nconst doSTA = (addr: number) => {\n  memSet(addr, s6502.Accum)\n}\n// STA ($FF),Y take 6 cycles, doesn't depend upon page boundary\nPCODE('STA', MODE.IND_Y, 0x91, 2, (vZP) => {doIndirectYinstruction(vZP, doSTA, false); return 6})\nPCODE('STA', MODE.IND, 0x92, 2, (vZP) => doIndirectInstruction(vZP, doSTA, false))\n\nPCODE('STX', MODE.ZP_REL, 0x86, 2, (vZP) => {memSet(vZP, s6502.XReg); return 3})\nPCODE('STX', MODE.ZP_Y, 0x96, 2, (vZP) => {memSet(oneByteAdd(vZP, s6502.YReg), s6502.XReg); return 4})\nPCODE('STX', MODE.ABS, 0x8E, 3, (vLo, vHi) => {memSet(address(vLo, vHi), s6502.XReg); return 4})\n\nPCODE('STY', MODE.ZP_REL, 0x84, 2, (vZP) => {memSet(vZP, s6502.YReg); return 3})\nPCODE('STY', MODE.ZP_X, 0x94, 2, (vZP) => {memSet(oneByteAdd(vZP, s6502.XReg), s6502.YReg); return 4})\nPCODE('STY', MODE.ABS, 0x8C, 3, (vLo, vHi) => {memSet(address(vLo, vHi), s6502.YReg); return 4})\n\nPCODE('STZ', MODE.ZP_REL, 0x64, 2, (vZP) => {memSet(vZP, 0); return 3})\nPCODE('STZ', MODE.ZP_X, 0x74, 2, (vZP) => {memSet(oneByteAdd(vZP, s6502.XReg), 0); return 4})\nPCODE('STZ', MODE.ABS, 0x9C, 3, (vLo, vHi) => {memSet(address(vLo, vHi), 0); return 4})\nPCODE('STZ', MODE.ABS_X, 0x9E, 3, (vLo, vHi) => {\n  const addr = twoByteAdd(vLo, vHi, s6502.XReg)\n  memGet(addr)  // extra strobe of the address (Sather IIe p. 4-27)\n  memSet(addr, 0)\n  return 5})\n\nPCODE('TAX', MODE.IMPLIED, 0xAA, 1, () => {s6502.XReg = s6502.Accum; checkStatus(s6502.XReg); return 2})\nPCODE('TAY', MODE.IMPLIED, 0xA8, 1, () => {s6502.YReg = s6502.Accum; checkStatus(s6502.YReg); return 2})\nPCODE('TSX', MODE.IMPLIED, 0xBA, 1, () => {s6502.XReg = s6502.StackPtr; checkStatus(s6502.XReg); return 2})\nPCODE('TXA', MODE.IMPLIED, 0x8A, 1, () => {s6502.Accum = s6502.XReg; checkStatus(s6502.Accum); return 2})\nPCODE('TXS', MODE.IMPLIED, 0x9A, 1, () => {s6502.StackPtr = s6502.XReg; return 2})\nPCODE('TYA', MODE.IMPLIED, 0x98, 1, () => {s6502.Accum = s6502.YReg; checkStatus(s6502.Accum); return 2})\n\n// var endTime = performance.now()\n// console.log(\"PCODE time = \" + (endTime - startTime))","import { pcodes } from \"./instructions\";\nimport { toHex, isRelativeInstr, MODE } from \"./utility\";\n\nconst parseOperand = (operand: string): [MODE, number] => {\n  let mode: MODE = MODE.IMPLIED;\n  let value = -1\n\n  if (operand.length > 0) {\n    if (operand.startsWith('#')) {\n      mode = MODE.IMM\n      operand = operand.substring(1)\n    } else if (operand.startsWith('(')) {\n      if (operand.endsWith(\",Y\")) {\n        mode = MODE.IND_Y\n      } else if (operand.endsWith(\",X)\")) {\n        mode = MODE.IND_X\n      } else {\n        mode = MODE.IND\n      }\n      operand = operand.substring(1)\n    } else if (operand.endsWith(\",X\")) {\n      mode = (operand.length > 5) ? MODE.ABS_X : MODE.ZP_X\n    } else if (operand.endsWith(\",Y\")) {\n      mode = (operand.length > 5) ? MODE.ABS_Y : MODE.ZP_Y\n    } else {\n      mode = (operand.length > 3) ? MODE.ABS : MODE.ZP_REL\n    }\n\n    if (operand.startsWith('$')) {\n      operand = \"0x\" + operand.substring(1)\n    }\n    value = parseInt(operand)\n  }\n\n  return [mode, value]\n}\n\n\nlet labels: { [key: string]: number } = {};\n\nconst doOutput = false\n\nconst getInstructionModeValue =\n  (pc: number, instr: string, operand: string, pass: 1 | 2): [MODE, number] => {\n    let mode = MODE.IMPLIED\n    let value = -1\n    const opParts = operand.match(\n      /(?<num>[#$0-9()]*)(?<label>[A-Z]*)(?<labelSym>[+-]*)(?<labelOperand>[0-9]*)/)?.groups\n    if (opParts) {\n      if (opParts.num) {\n        [mode, value] = parseOperand(operand)\n      } else if (opParts.label) {\n        if (!(opParts.label in labels)) {\n          if (pass === 2) {\n            console.error(\"Missing label: \" + opParts.label)\n            return [mode, value]\n          }\n        } else {\n          value = labels[opParts.label]\n        }\n        if (isRelativeInstr(instr)) {\n          mode = MODE.ZP_REL\n          value = (value - pc + 254) % 256\n        } else {\n          mode = MODE.ABS\n        }\n        if (opParts.labelSym && opParts.labelOperand) {\n          if (opParts.labelSym === '+') {\n            value += parseInt(opParts.labelOperand)\n          } else if (opParts.labelSym === '-') {\n            value -= parseInt(opParts.labelOperand)\n          }\n        }\n      }\n    }\n    return [mode, value]\n}\n\nconst parseOnce = (start: number, code: Array<string>, pass: 1 | 2): Array<number> => {\n  let pc = start\n  let instructions: Array<number> = [];\n  code.forEach(line => {\n    let newInstructions: Array<number> = [];\n    let hexValue = ''\n\n    line = (line.split(';'))[0].trimEnd().toUpperCase()\n\n    let output = (line + '                   ').slice(0, 30) + toHex(pc, 4) + \"- \"\n\n    const parts = line.match(/(?<label>[A-Z]*) *(?<instr>[A-Z]*) *(?<operand>.*)/)?.groups\n    if (line && parts) {\n\n      parts.operand = parts.operand.replace(/\\s/g, '')\n      if (parts.operand && !parts.instr) {\n        console.error(\"Missing instruction: \" + line)\n        instructions = []\n        return\n      }\n\n      if (parts.instr === 'ORG') {\n        if (doOutput && pass === 2) console.log(output)\n        return\n      }\n\n      if (pass === 1 && parts.label) {\n        if (parts.label in labels) {\n          console.error(\"Redefined label: \" + parts.label)\n          instructions = []\n          return\n        }\n        if (parts.instr === 'EQU') {\n          const [mode, value] = parseOperand(parts.operand)\n          if (mode !== MODE.ABS && mode !== MODE.ZP_REL) {\n            console.error(\"Illegal EQU value: \" + parts.operand)\n            instructions = []\n            return\n          }\n          labels[parts.label] = value\n          if (doOutput) console.log(output)\n          return\n        } else {\n          labels[parts.label] = pc\n        }\n      }\n      if (parts.instr === 'EQU') {\n        return\n      }\n\n      const [mode, value] = getInstructionModeValue(pc, parts.instr, parts.operand, pass)\n\n      let match = -1\n      match = pcodes.findIndex(pc => pc && pc.name === parts.instr && pc.mode === mode)\n      if (match >= 0) {\n        const pcode = pcodes[match]\n        newInstructions.push(match);\n        output += toHex(match)\n        if (value >= 0) {\n          if (pcode.mode !== mode) {\n            console.error(\"Mismatch between instruction and mode: \" + line)\n            instructions = []\n            return\n          }\n          newInstructions.push(value % 256)\n          output += ' ' + toHex(newInstructions[1])\n          if (pcode.PC === 3) {\n            newInstructions.push(Math.trunc(value / 256))\n            output += ' ' + toHex(newInstructions[2])\n            hexValue = toHex(value, 4)\n          } else {\n            output += \"   \"\n            hexValue = toHex(value)\n          }\n        } else {\n          output += \"      \"\n        }\n        pc += pcode.PC\n      } else {\n        console.error(\"Unknown instruction: \" + line)\n        instructions = []\n        return\n      }\n\n      output += '  ' + parts.instr + (hexValue !== '' ? \" $\" + hexValue : '')\n      if (doOutput && pass === 2) console.log(output)\n      instructions.push(...newInstructions)\n    }\n  });\n\n  return instructions\n}\n\nexport const parseAssembly = (start: number, code: Array<string>): Array<number> => {\n  labels = {}\n  parseOnce(start, code, 1)\n  const instructions = parseOnce(start, code, 2)\n  return instructions\n}\n\n","\n// export const code = ''\nexport const code = `\n         ORG   $300\nFREQ     EQU   $350\nPLSWIDTH EQU   $352\n\n         LDA   #$FF\n         STA   FREQ\n         LDA   #$80\n         STA   PLSWIDTH\nPLAY     LDA   $C030\n         LDY   PLSWIDTH\nPULSE    DEY\n         BNE   PULSE\n         LDA   $C030\n         LDX   FREQ\nCOUNTDN  DEX\n         BNE   COUNTDN\n         JSR   READKB\n         JMP   PLAY\n\nINCR     INC   FREQ\n         RTS\n\nDECR     DEC   FREQ\n         RTS\n\nPULSEINC DEC   PLSWIDTH\n         INC   FREQ\n         RTS\n\nPULSEDEC INC   PLSWIDTH\n         DEC   FREQ\n         RTS\n\nREADKB   LDA   $C000\n         STA   $C010   \n         CMP   #$88\n         BEQ   INCR\n         CMP   #$95\n         BEQ   DECR\n         CMP   #$C1\n         BEQ   PULSEINC\n         CMP   #$DA\n         BEQ   PULSEDEC\n         RTS\n`\n","import { parseAssembly } from \"./assembler\"\nimport { setSlotDriver, mainMem } from \"./memory\"\nimport { SWITCHES } from \"./softswitches\"\nimport { passDriveProps } from \"./worker2main\"\n\nlet currentDrive = 0\nlet timerID: any | number = 0\nconst driverAddress = 0xC7EA\n\nconst code1 = `\n         LDX   #$20\n         LDA   #$00\n         LDX   #$03\n         LDA   #$01\n         STA   $42\n         LDA   #$70\n         STA   $43\n         LDA   #$08\n         STA   $45\n         LDA   #$00\n         STA   $44\n         STA   $46\n         STA   $47\n         JSR   $C7EA\n         BCS   ERROR\n         LDA   #$0A\n         STA   $45\n         LDA   #$01\n         STA   $46\n         JSR   $C7EA\n         BCS   ERROR\n         LDA   $0801\n         BEQ   ERROR\n         LDA   #$01\n         CMP   $0800\n         BNE   ERROR\n         LDX   $43\n         JMP   $801\nERROR    JMP   $E000\n`\nconst code2 = `\n         CLC\n         LDA   #$00\n         RTS\n         SEC         ; addr + 4\n         LDA   #$27\n         RTS\n`\nconst prodos8driver = () => {\n  const driver = new Uint8Array(256).fill(0)\n  let pcode = parseAssembly(0x0, code1.split(\"\\n\"))\n  driver.set(pcode, 0)\n  pcode = parseAssembly(0x0, code2.split(\"\\n\"))\n  driver.set(pcode, 0xEA)\n  driver[0xFE] = 0b00010011\n  driver[0xFF] = 0xEA\n  return driver\n}\n\nexport const enableHardDrive = () => {\n  setSlotDriver(7, prodos8driver())\n}\n\nconst initDriveProps = (): DriveProps => {\n  return {\n    hardDrive: false,\n    drive: 0,\n    filename: \"\",\n    status: \"\",\n    halftrack: 0,\n    diskHasChanges: false,\n    motorRunning: false,\n    diskData: new Uint8Array()\n  }\n}\nlet driveState: DriveProps[] = [initDriveProps(), initDriveProps(), initDriveProps()];\n\nconst decodeDiskData = (driveState: DriveProps, diskData: Uint8Array): Uint8Array => {\n  driveState.diskHasChanges = false\n  return diskData\n  // if (decodeDSK(driveState, diskData)) {\n  //   return diskData\n  // }\n  // console.error(\"Unknown disk format.\")\n  // driveState.filename = \"\"\n  // return new Uint8Array()\n}\n\nexport const doSetHardDriveProps = (props: DriveProps) => {\n  currentDrive = props.drive\n  driveState[props.drive] = initDriveProps()\n  driveState[props.drive].hardDrive = props.hardDrive\n  driveState[props.drive].drive = props.drive\n  driveState[props.drive].diskData = new Uint8Array()\n  driveState[props.drive].status = props.filename\n  driveState[props.drive].filename = props.filename\n  driveState[props.drive].motorRunning = props.motorRunning\n  if (props.diskData.length > 0) {\n    driveState[props.drive].diskData = decodeDiskData(driveState[props.drive], props.diskData)\n  }\n  passData()\n}\n\nconst passData = () => {\n  for (let i = 0; i < driveState.length; i++) {\n    if (driveState[i].hardDrive) {\n      const dprops: DriveProps = {\n        hardDrive: true,\n        drive: i,\n        filename: driveState[i].filename,\n        status: driveState[i].status,\n        motorRunning: driveState[i].motorRunning,\n        halftrack: driveState[i].halftrack,\n        diskHasChanges: driveState[i].diskHasChanges,\n        diskData: new Uint8Array()\n      }\n      passDriveProps(dprops)\n    }\n  }\n}\n\nconst motorTimeout = () => {\n  timerID = 0\n  driveState[currentDrive].motorRunning = false\n  passData()\n}\n\nexport const processHardDriveBlockAccess = () => {\n  const result = driverAddress\n  if (mainMem[0x43] !== 0x70) {\n    console.log(\"illegal value in 0x42: \" + mainMem[0x43])\n    return result\n  }\n  if (driveState[currentDrive].filename.length === 0) {\n    return result + 4\n  }\n  const block = mainMem[0x46] + 256 * mainMem[0x47]\n  const blockStart = 512 * block\n  let addr = mainMem[0x44] + 256 * mainMem[0x45]\n  console.log(`cmd=${mainMem[0x42]} addr=${addr.toString(16)} block=${block.toString(16)}`)\n  if (addr >= 0xD000 && addr <= 0xDFFF) {\n    // Bank1 of $D000-$DFFF is stored in $C000, so adjust address if necessary\n    if (!SWITCHES.BSRBANK2.isSet) {\n      addr -= 0x1000\n    }\n  }\n\n  switch (mainMem[0x42]) {\n    case 0:\n      console.log(\"status\")\n      break;\n    case 1:\n      if (blockStart + 512 > driveState[currentDrive].diskData.length) {\n        console.error(\"block start > harddisk length\")\n      }\n      const dataRead = driveState[currentDrive].diskData.slice(blockStart, blockStart + 512)\n      mainMem.set(dataRead, addr)\n      break;\n    case 2:\n      if (blockStart + 512 > driveState[currentDrive].diskData.length) {\n        console.error(\"block start > harddisk length\")\n      }\n      const dataWrite = mainMem.slice(addr, addr + 512)\n      driveState[currentDrive].diskData.set(dataWrite, blockStart)\n      break;\n    case 3:\n      console.log(\"format\")\n      break;\n    default:\n      console.log(\"unknown hard drive command\")\n      return result + 4\n  }\n\n  driveState[currentDrive].motorRunning = true\n  if (!timerID) {\n    timerID = setTimeout(motorTimeout, 500)\n  }\n  passData()\n  return result\n}","// Chris Torrence, 2022\nimport { Buffer } from \"buffer\"\nimport { passMachineState } from \"./worker2main\"\nimport { s6502, set6502State, reset6502, pcodes,\n  incrementPC, cycleCount, setCycleCount, setPC } from \"./instructions\"\nimport { STATE, getProcessorStatus, getInstrString, debugZeroPage } from \"./utility\"\nimport { getDriveState, setDriveState, doResetDrive, doPauseDrive } from \"./diskdata\"\n// import { slot_omni } from \"./roms/slot_omni_cx00\"\nimport { SWITCHES } from \"./softswitches\";\nimport { memGet, mainMem, auxMem, memC000, getTextPage, getHires } from \"./memory\"\nimport { setButtonState, handleGamepad } from \"./joystick\"\nimport { parseAssembly } from \"./assembler\";\nimport { code } from \"./assemblycode\"\nimport { enableHardDrive, processHardDriveBlockAccess } from \"./harddrivedata\"\n\n// let timerID: any | number = 0\nlet startTime = 0\nlet prevTime = 0\nlet normalSpeed = true\nlet speed = 0\nlet refreshTime = 16.6881 // 17030 / 1020.488\nlet timeDelta = 0\nlet cpuState = STATE.IDLE\nlet iRefresh = 0\nlet saveTimeSlice = false\nlet iSaveState = 0\nlet iTempState = 0\nlet maxState = 60\nlet saveStates = Array<string>(maxState).fill('')\n// let prevMemory = Buffer.from(mainMem)\n// let DEBUG_ADDRESS = -1 // 0x9631\nlet doDebug = false\nlet doDebugZeroPage = false\nconst instrTrail = new Array<string>(1000)\nlet posTrail = 0\nlet breakpoint = 0\n\nconst getApple2State = (): SAVEAPPLE2STATE => {\n  const softSwitches: { [name: string]: boolean } = {}\n  for (const key in SWITCHES) {\n    softSwitches[key] = SWITCHES[key as keyof typeof SWITCHES].isSet\n  }\n  const memory = Buffer.from(mainMem)\n  const memAux = Buffer.from(auxMem)\n  // let memdiff: { [addr: number]: number } = {};\n  // for (let i = 0; i < memory.length; i++) {\n  //   if (prevMemory[i] !== memory[i]) {\n  //     memdiff[i] = memory[i]\n  //   }\n  // }\n  // prevMemory = memory\n  return {\n    s6502: s6502,\n    softSwitches: softSwitches,\n    memory: memory.toString(\"base64\"),\n    memAux: memAux.toString(\"base64\"),\n    memc000: Buffer.from(memC000).toString(\"base64\"),\n  }\n}\n\nconst setApple2State = (newState: SAVEAPPLE2STATE) => {\n  set6502State(newState.s6502)\n  const softSwitches: { [name: string]: boolean } = newState.softSwitches\n  for (const key in softSwitches) {\n    const keyTyped = key as keyof typeof SWITCHES\n    try {\n      SWITCHES[keyTyped].isSet = softSwitches[key]    \n    } catch (error) {\n    }\n  }\n  mainMem.set(Buffer.from(newState.memory, \"base64\"))\n  memC000.set(Buffer.from(newState.memc000, \"base64\"))\n  if (newState.memAux !== undefined) {\n    auxMem.set(Buffer.from(newState.memAux, \"base64\"))\n  }\n}\n\n// export const doRequestSaveState = () => {\n//   passSaveState(doGetSaveState())\n// }\n\nexport const doGetSaveState = () => {\n  const state = { state6502: getApple2State(), driveState: getDriveState() }\n  return JSON.stringify(state)\n//  return Buffer.from(compress(JSON.stringify(state)), 'ucs2').toString('base64')\n}\n\nexport const doRestoreSaveState = (sState: string) => {\n  const state = JSON.parse(sState);\n  setApple2State(state.state6502 as SAVEAPPLE2STATE)\n  setDriveState(state.driveState)\n  updateExternalMachineState()\n}\n\nconst doBoot = () => {\n  setCycleCount(0)\n  mainMem.fill(0xFF)\n  auxMem.fill(0xFF)\n  if (code.length > 0) {\n    let pcode = parseAssembly(0x300, code.split(\"\\n\"));\n    mainMem.set(pcode, 0x300);\n  }\n  enableHardDrive()\n  doReset()\n}\n\nconst doReset = () => {\n  memC000.fill(0)\n  for (const key in SWITCHES) {\n    const keyTyped = key as keyof typeof SWITCHES\n    SWITCHES[keyTyped].isSet = false\n  }\n  SWITCHES.TEXT.isSet = true\n  // Reset banked RAM\n  memGet(0xC082)\n  reset6502()\n  doResetDrive()\n  setButtonState()\n}\n\nexport const doSetNormalSpeed = (normal: boolean) => {\n  normalSpeed = normal\n  refreshTime = normalSpeed ? 16.6881 : 0\n  resetRefreshCounter()\n}\n\nexport const doGoBackInTime = () => {\n  doSetCPUState(STATE.PAUSED)\n  // if this is the first time we're called, make sure our current\n  // state is up to date\n  if (iTempState === iSaveState) {\n    saveStates[iSaveState] = doGetSaveState()\n  }\n  const newTmp = (iTempState + maxState - 1) % maxState\n  if (newTmp === iSaveState || saveStates[newTmp] === '') {\n    return\n  }\n  iTempState = newTmp\n  doRestoreSaveState(saveStates[newTmp])\n}\n\nexport const doGoForwardInTime = () => {\n  doSetCPUState(STATE.PAUSED)\n  if (iTempState === iSaveState) {\n    return\n  }\n  const newTmp = (iTempState + 1) % maxState\n  if (saveStates[newTmp] === '') {\n    return\n  }\n  iTempState = newTmp\n  doRestoreSaveState(saveStates[newTmp])\n}\n\nexport const doSaveTimeSlice = () => {\n  // Set a flag and save our slice at the end of the next 6502 display cycle.\n  // Otherwise we risk saving in the middle of a keystroke.\n  saveTimeSlice = true\n}\n\nexport const doStepOnce = () => {\n  doDebug = true\n  if (cpuState === STATE.IDLE) {\n    doBoot()\n  }\n  processInstruction(true)\n  cpuState = STATE.PAUSED\n  updateExternalMachineState()\n}\n\nconst resetRefreshCounter = () => {\n  iRefresh = 0\n  prevTime = performance.now()\n  startTime = prevTime\n}\n\nexport const doSetCPUState = (cpuStateIn: STATE) => {\n  cpuState = cpuStateIn\n  if (cpuState === STATE.PAUSED || cpuState === STATE.RUNNING) {\n    doPauseDrive(cpuState === STATE.RUNNING)\n  }\n  updateExternalMachineState()\n  resetRefreshCounter()\n  if (speed === 0) {\n    doAdvance6502Timer()\n  }\n}\n\nexport const doSetBreakpoint = (breakpt: number) => {\n  breakpoint = breakpt\n  if (breakpoint !== 0) doDebug = true\n}\n\nexport const processInstruction = (step = false) => {\n  let cycles = 0\n  let PC1 = s6502.PC\n  const instr = memGet(s6502.PC)\n  const vLo = s6502.PC < 0xFFFF ? memGet(s6502.PC + 1) : 0\n  const vHi = s6502.PC < 0xFFFE ? memGet(s6502.PC + 2) : 0\n  let code = pcodes[instr]\n  if (!code) {\n    code = pcodes[0xEA]\n  }\n  if (code) {\n//    const mainMem1 = mainMem\n    if (PC1 === breakpoint && !step) {\n      cpuState = STATE.PAUSED\n      return -1\n    }\n    // HACK\n    // if (PC1 === 0xFA62 && cycleCount > 10000) {\n    //   doDebug = true\n    // }\n    // if (PC1 === 0xC700) {\n    //   doDebug = false\n    // }\n    if (PC1 === 0xC7EA && !SWITCHES.INTCXROM.isSet) {\n      PC1 = processHardDriveBlockAccess()\n      if (PC1 !== s6502.PC) {\n        setPC(PC1)\n        return 0\n      }\n    }\n    // END HACK\n    // if (PC1 >= 0xC700 && PC1 <= 0xC7FF) {\n    //     doDebug = true\n    // }\n    // if (PC1 === 0x22E8) {\n    //   doDebug = false\n    // }\n    // if (PC1 === 0xD229) {\n    //    doDebug = true\n    // }\n    cycles = code.execute(vLo, vHi)\n    let out = '----'\n    // Do not output during the Apple II's WAIT subroutine\n    if ((PC1 < 0xFCA8 || PC1 > 0xFCB3) && PC1 < 0xFF47) {\n      const cc = (cycleCount.toString() + '      ').slice(0, 10)\n      const ins = getInstrString(code, vLo, vHi, PC1) + '            '\n      out = `${cc}  ${ins.slice(0, 22)}  ${getProcessorStatus(s6502)}`\n    }\n    instrTrail[posTrail] = out\n    posTrail = (posTrail + 1) % instrTrail.length\n    if (doDebug) {\n//      const mem = mainMem.slice(0, 256)\n      if (instr === 0) doDebug = false\n      console.log(out)\n      if (doDebugZeroPage) {\n        debugZeroPage(mainMem.slice(0, 256))\n      }\n    }\n    // if (doDebug) {\n    //   instrTrail.slice(posTrail).forEach(s => console.log(s));\n    //   instrTrail.slice(0, posTrail).forEach(s => console.log(s));\n    //   console.log(\"stop!!!\")\n    // }\n    setCycleCount(cycleCount + cycles)\n    incrementPC(code.PC)\n  }\n  return cycles\n}\n\nconst updateExternalMachineState = () => {\n  const state: MachineState = {\n    state: cpuState,\n    speed: speed,\n    altChar: SWITCHES.ALTCHARSET.isSet,\n    textPage: getTextPage(),\n    lores: getTextPage(true),\n    hires: getHires()\n  }\n  passMachineState(state)\n}\n\nconst doAdvance6502 = () => {\n  const newTime = performance.now()\n  timeDelta = newTime - prevTime\n  if (timeDelta < refreshTime) return\n  prevTime = newTime\n  if (cpuState === STATE.IDLE || cpuState === STATE.PAUSED) {\n    return;\n  }\n  if (cpuState === STATE.NEED_BOOT) {\n    doBoot();\n    doSetCPUState(STATE.RUNNING)\n  } else if (cpuState === STATE.NEED_RESET) {\n    doReset();\n    doSetCPUState(STATE.RUNNING)\n  }\n  let cycleTotal = 0\n  while (true) {\n    const cycles = processInstruction();\n    if (cycles < 0) break\n    cycleTotal += cycles;\n    if (cycleTotal >= 17030) {\n      break;\n    }\n  }\n  iRefresh++\n  speed = (iRefresh * 17.030) / (performance.now() - startTime)\n  updateExternalMachineState()\n  handleGamepad()\n  if (saveTimeSlice) {\n    saveTimeSlice = false\n    iSaveState = (iSaveState + 1) % maxState\n    iTempState = iSaveState\n//    console.log(\"iSaveState \" + iSaveState)\n    saveStates[iSaveState] = doGetSaveState()\n  }\n}\n\nconst doAdvance6502Timer = () => {\n  doAdvance6502()\n  const iRefreshFinish = (iRefresh + 9)\n  while (cpuState === STATE.RUNNING && iRefresh !== iRefreshFinish) {\n    doAdvance6502()\n  }\n  setTimeout(doAdvance6502Timer, 0)\n}\n","import { doSetCPUState, doSetBreakpoint,\n  doGetSaveState, doRestoreSaveState, doSetNormalSpeed,\n  doGoBackInTime, doGoForwardInTime, doStepOnce } from \"./motherboard\";\nimport { doSetDriveProps } from \"./diskdata\"\nimport { doSetHardDriveProps } from \"./harddrivedata\"\nimport { addToBuffer } from \"./keyboard\"\nimport { pressAppleCommandKey, setGamepad } from \"./joystick\"\nimport { DRIVE } from \"./utility\";\n\n// This file must have worker types, but not DOM types.\n// The global should be that of a dedicated worker.\n\n// This fixes `self`'s type.\ndeclare var self: DedicatedWorkerGlobalScope;\nexport {};\n\nconst doPostMessage = (msg: string, payload: any) => {\n  self.postMessage({msg, payload});\n}\n\nexport const passMachineState = (state: MachineState) => {\n  doPostMessage(\"MACHINE_STATE\", state)\n}\n\nexport const passClickSpeaker = (cycleCount: number) => {\n  doPostMessage(\"CLICK\", cycleCount)\n}\n\nexport const passDriveProps = (props: DriveProps) => {\n  doPostMessage(\"DRIVE_PROPS\", props)\n}\n\nexport const passDriveSound = (sound: DRIVE) => {\n  doPostMessage(\"DRIVE_SOUND\", sound)\n}\n\nconst passSaveState = (saveState: string) => {\n  doPostMessage(\"SAVE_STATE\", saveState)\n}\n\nself.onmessage = (e: MessageEvent) => {\n  switch (e.data.msg) {\n    case \"STATE\":\n      doSetCPUState(e.data.payload)\n      break;\n    case \"BREAKPOINT\":\n      doSetBreakpoint(e.data.payload)\n      break;\n    case \"STEP_ONCE\":\n      doStepOnce()\n      break;\n    case \"SPEED\":\n      doSetNormalSpeed(e.data.payload)\n      break;\n    case \"TIME_TRAVEL\":\n      if (e.data.payload === \"FORWARD\") {\n          doGoForwardInTime()\n      } else {\n          doGoBackInTime()\n      }\n      break;\n    case \"RESTORE_STATE\":\n      doRestoreSaveState(e.data.payload)\n      break;\n    case \"KEYBUFFER\":\n      addToBuffer(e.data.payload)\n      break;\n    case \"APPLE_PRESS\":\n      pressAppleCommandKey(true, e.data.payload)\n      break;\n    case \"APPLE_RELEASE\":\n      pressAppleCommandKey(false, e.data.payload)\n      break;\n    case \"GET_SAVE_STATE\":\n      passSaveState(doGetSaveState())\n      break;\n    case \"DRIVE_PROPS\":\n      const props = e.data.payload as DriveProps\n      if (props.hardDrive) {\n        doSetHardDriveProps(props)\n      } else {\n        doSetDriveProps(props)\n      }\n      break;\n    case \"GAMEPAD\":\n      setGamepad(e.data.payload)\n      break\n    default:\n      console.log(\"worker2main onmessage: unknown msg: \" + JSON.stringify(e.data))\n      break;\n  }\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n// the startup function\n__webpack_require__.x = function() {\n\t// Load entry module and return exports\n\t// This entry module depends on other loaded chunks and execution need to be delayed\n\tvar __webpack_exports__ = __webpack_require__.O(undefined, [766], function() { return __webpack_require__(233); })\n\t__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n\treturn __webpack_exports__;\n};\n\n","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = function(chunkId) {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce(function(promises, key) {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks and sibling chunks for the entrypoint\n__webpack_require__.u = function(chunkId) {\n\t// return url for filenames based on template\n\treturn \"static/js/\" + chunkId + \".\" + \"cd8d8aa5\" + \".chunk.js\";\n};","// This function allow to reference async chunks and sibling chunks for the entrypoint\n__webpack_require__.miniCssF = function(chunkId) {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","__webpack_require__.p = \"/\";","// no baseURI\n\n// object to store loaded chunks\n// \"1\" means \"already loaded\"\nvar installedChunks = {\n\t233: 1\n};\n\n// importScripts chunk loading\nvar installChunk = function(data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\tfor(var moduleId in moreModules) {\n\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t}\n\t}\n\tif(runtime) runtime(__webpack_require__);\n\twhile(chunkIds.length)\n\t\tinstalledChunks[chunkIds.pop()] = 1;\n\tparentChunkLoadingFunction(data);\n};\n__webpack_require__.f.i = function(chunkId, promises) {\n\t// \"1\" is the signal for \"already loaded\"\n\tif(!installedChunks[chunkId]) {\n\t\tif(true) { // all chunks have JS\n\t\t\timportScripts(__webpack_require__.p + __webpack_require__.u(chunkId));\n\t\t}\n\t}\n};\n\nvar chunkLoadingGlobal = self[\"webpackChunkapple2ts\"] = self[\"webpackChunkapple2ts\"] || [];\nvar parentChunkLoadingFunction = chunkLoadingGlobal.push.bind(chunkLoadingGlobal);\nchunkLoadingGlobal.push = installChunk;\n\n// no HMR\n\n// no HMR manifest","var next = __webpack_require__.x;\n__webpack_require__.x = function() {\n\treturn __webpack_require__.e(766).then(next);\n};","// run startup\nvar __webpack_exports__ = __webpack_require__.x();\n"],"names":["STATE","DRIVE","MODE","isRelativeInstr","instr","startsWith","toHex","value","ndigits","toString","toUpperCase","slice","getProcessorStatus","s6502","Accum","XReg","YReg","PStatus","P","StackPtr","getInstrString","code","vLo","vHi","PC","result","mode","prefix","suffix","IMM","ZP_X","ABS_X","ZP_Y","ABS_Y","IND","IND_X","IND_Y","modeString","name","addr","address","toASCII","Uint8Array","s","split","map","char","charCodeAt","uint32toBytes","n","keyBuffer","popKey","memC000","key","keyPress","length","doSaveTimeSlice","fill","gamePad","maxTimeoutCycles","Math","trunc","paddle0timeout","paddle1timeout","countStart","leftAppleDown","rightAppleDown","leftButtonDown","rightButtonDown","isRightDown","setButtonState","SWITCHES","PB0","isSet","PB1","pressAppleCommandKey","isDown","left","memSet1","funcs","nearZero","sswitch","NewSwitch","offAddr","isSetAddr","writeOnly","setFunc","onAddr","rand","floor","random","handleBankedRAM","READBSR2","WRITEBSR2","OFFBSR2","RDWRBSR2","READBSR1","WRITEBSR1","OFFBSR1","RDWRBSR1","BSRBANK2","BSRREADRAM","includes","STORE80","RAMRD","RAMWRT","INTCXROM","ALTZP","SLOTC3ROM","COLUMN80","ALTCHARSET","KBRDSTROBE","CASSOUT","SPEAKER","cycleCount","passClickSpeaker","EMUBYTE","TEXT","MIXED","PAGE2","HIRES","AN0","AN1","AN2","AN3","CASSIN1","PB2","JOYSTICK12","diff","checkJoystickValues","CASSIN2","JOYSTICKRESET","resetJoystick","DRVSM0","DRVSM1","DRVSM2","DRVSM3","DRVSEL","DRVDATA","DRVWRITE","checkSoftSwitches","calledFromMemSet","sswitch1","func","console","error","write_byte","woz","position","shift","byte_position","write_4_and_4","write_sync","encode_6_and_2","src","six_and_two_mapping","dest","bit_reverse","c","location","serialise_track","track_number","is_prodos","track_position","sector","ls","contents","crcTable","Uint32Array","makeCRCTable","k","decodeWoz2","driveState","diskData","undefined","find","i","isWriteProtected","crc","storedCRC","actualCRC","data","offset","crc32","alert","filename","htrack","tmap_index","tmap_offset","trk","trackStart","trackNbits","decodeDSK","f","dskData","isPO","set","trackInput","trackData","convertdsk2woz","endsWith","lastIndexOf","substring","diskHasChanges","initDriveState","halftrack","prevHalfTrack","writeMode","currentPhase","motorRunning","Array","trackLocation","currentDrive","motorOffTimeout","getDriveState","driveData","Buffer","passData","dprops","hardDrive","drive","status","passDriveProps","moveHead","dd","passDriveSound","TRACK_END","TRACK_SEEK","pickbit","clearbit","getNextBit","bit","fileOffset","byte","b","dataRegister","prevCycleCount","doWriteBit","doWriteByte","delta","debugCache","push","doMotorTimeout","MOTOR_OFF","startMotor","clearTimeout","MOTOR_ON","dumpData","handleDriveSoftSwitches","getNextByte","setTimeout","ps","a","ascend","descend","doSetDriveProps","props","isDSK","decodeWoz1","decodeDiskData","mainMem","auxMem","empty","slots","rom","replaceAll","memGetSoftSwitch","memGetBankC000","slot","memGet","readAuxMem","memSet","writeAuxMem","TEXT_PAGE1","TEXT_PAGE2","getTextPage","getLores","jstart","jend","is80column","pageOffset","textPage","j","joffset","start","getHires","doubleRes","nlines","hgrPage","setCycleCount","cycles","incrementPC","setPC","assert","isNaN","setPStatus","stack","pushStack","call","popStack","Error","isCarry","setCarry","isZero","setZero","setInterrupt","isDecimal","BCD","setDecimal","setBreak","isOverflow","setOverflow","isNegative","setNegative","checkStatus","doBranch","takeBranch","oldPC","pageBoundary","oneByteAdd","twoByteAdd","addr1","addr2","pcodes","PCODE","pcode","execute","doIndirectYinstruction","vZP","doInstruction","addBCD","doIndirectInstruction","doADC_BCD","ones","tmp","bothPositive","bothNegative","doADC_HEX","doADC","ZP_REL","ABS","vOffset","doAND","doASL","v","IMPLIED","doBit","PC2","doCMP","doCMP1","doCPX","doCPY","doDEC","doEOR","doINC","doLDA","doLDX","doLDY","doLSR","doORA","doROL","bit0","doROR","bit7","doSBC_BCD","vtmp","newCarry","doSBC","doSTA","parseOperand","operand","parseInt","labels","parseOnce","pass","pc","instructions","forEach","line","newInstructions","hexValue","parts","trimEnd","match","groups","replace","label","opParts","num","labelSym","labelOperand","getInstructionModeValue","findIndex","parseAssembly","timerID","enableHardDrive","driver","prodos8driver","initDriveProps","motorTimeout","processHardDriveBlockAccess","log","block","blockStart","dataRead","dataWrite","startTime","prevTime","speed","refreshTime","cpuState","IDLE","iRefresh","saveTimeSlice","iSaveState","iTempState","saveStates","doDebug","instrTrail","posTrail","breakpoint","getApple2State","softSwitches","memory","memAux","memc000","setApple2State","newState","new6502","keyTyped","doGetSaveState","state","state6502","JSON","stringify","doRestoreSaveState","sState","parse","fileName","diskImageHasChanges","motorIsRunning","setDriveState","updateExternalMachineState","doBoot","doReset","resetRefreshCounter","performance","now","doSetCPUState","cpuStateIn","PAUSED","RUNNING","doPauseDrive","doAdvance6502Timer","processInstruction","step","PC1","out","cc","ins","altChar","lores","hires","passMachineState","doAdvance6502","newTime","NEED_BOOT","NEED_RESET","cycleTotal","connected","xstick","axes","ystick","abs","dist","sqrt","clip","max","min","buttons","button","handleGamepad","iRefreshFinish","doPostMessage","msg","payload","self","postMessage","sound","onmessage","e","breakpt","normal","newTmp","doGoForwardInTime","doGoBackInTime","text","saveState","doSetHardDriveProps","gamePadIn","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","m","x","__webpack_exports__","O","deferred","chunkIds","fn","priority","notFulfilled","Infinity","fulfilled","Object","keys","every","splice","r","d","definition","o","defineProperty","enumerable","get","chunkId","Promise","all","reduce","promises","u","miniCssF","obj","prop","prototype","hasOwnProperty","p","installedChunks","importScripts","chunkLoadingGlobal","parentChunkLoadingFunction","bind","moreModules","runtime","pop","next","then"],"sourceRoot":""}